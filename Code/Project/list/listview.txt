; generated by Component: ARM Compiler 5.05 (build 41) Tool: ArmCC [4d0eb9]
; commandline ArmCC [--list --split_sections -c --asm --interleave -o.\obj\listview.o --asm_dir=.\list\ --list_dir=.\list\ --depend=.\obj\listview.d --cpu=Cortex-M3 --apcs=interwork -O3 -I..\Board_Support_Package -I..\Config -I..\GUI\Core -I..\GUI\JPEG -I..\GUI\LCDDriver -I..\GUI\MultiLayer -I..\GUI\Widget -I..\GUI\WM -I..\Libraries\CMSIS\CM3\CoreSupport -I..\Libraries\CMSIS\CM3\DeviceSupport\ST\STM32F10x -I..\Libraries\CMSIS\Include -I..\Libraries\STM32F10x_StdPeriph_Driver\inc -I..\User\Res -I..\User\UserWindow -I..\User -I..\USB\inc -IC:\Keil_v5\ARM\RV31\INC -IC:\Keil_v5\ARM\CMSIS\Include -IC:\Keil_v5\ARM\Inc\ST\STM32F10x -D__MICROLIB -DSTM32F10X_HD -DVECT_TAB_FLASH -DUSE_STDPERIPH_DRIVER --no_multibyte_chars ..\GUI\Widget\LISTVIEW.c]
                          THUMB

                          AREA ||i.LISTVIEW_AddColumn||, CODE, READONLY, ALIGN=1

                  LISTVIEW_AddColumn PROC
;;;970    */
;;;971    int LISTVIEW_AddColumn(LISTVIEW_Handle hObj, int Width, const char * s, int Align) {
000000  e92d47fc          PUSH     {r2-r10,lr}
000004  461c              MOV      r4,r3
000006  4615              MOV      r5,r2
000008  4689              MOV      r9,r1
00000a  ea5f0800          MOVS     r8,r0
;;;972      int r = 0;
00000e  f04f0700          MOV      r7,#0
000012  d03a              BEQ      |L1.138|
;;;973      if (hObj) {
;;;974        LISTVIEW_Obj* pObj;
;;;975        LISTVIEW_COLUMN Column = {0};
000014  2000              MOVS     r0,#0
000016  9000              STR      r0,[sp,#0]
;;;976        unsigned NumRows;
;;;977        WM_LOCK();
;;;978        pObj = LISTVIEW_H2P(hObj);
000018  9001              STR      r0,[sp,#4]
00001a  4640              MOV      r0,r8
00001c  f7fffffe          BL       GUI_ALLOC_h2p
000020  4606              MOV      r6,r0
;;;979        HEADER_AddItem(pObj->hHeader, Width, s, Align);
000022  f9b00028          LDRSH    r0,[r0,#0x28]
000026  4623              MOV      r3,r4
000028  462a              MOV      r2,r5
00002a  4649              MOV      r1,r9
00002c  f7fffffe          BL       HEADER_AddItem
;;;980        Column.Align = Align;
000030  f88d4000          STRB     r4,[sp,#0]
;;;981        GUI_ARRAY_AddItem(&pObj->ColumnArray, &Column, sizeof(LISTVIEW_COLUMN));
000034  2208              MOVS     r2,#8
000036  4669              MOV      r1,sp
000038  f106002e          ADD      r0,r6,#0x2e
00003c  f7fffffe          BL       GUI_ARRAY_AddItem
;;;982        pObj = LISTVIEW_H2P(hObj); /* Restore after allocating memory */
000040  4640              MOV      r0,r8
000042  f7fffffe          BL       GUI_ALLOC_h2p
000046  4605              MOV      r5,r0
;;;983        NumRows = LISTVIEW__GetNumRows(pObj);
000048  f7fffffe          BL       LISTVIEW__GetNumRows
00004c  0006              MOVS     r6,r0
;;;984        if (NumRows) {
00004e  d014              BEQ      |L1.122|
;;;985          LISTVIEW_ROW* pRow;
;;;986          unsigned i;
;;;987          for (i = 0; i < NumRows; i++) {
000050  2400              MOVS     r4,#0
000052  e010              B        |L1.118|
                  |L1.84|
;;;988            pRow = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, i);
000054  4621              MOV      r1,r4
000056  f105002a          ADD      r0,r5,#0x2a
00005a  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;989            if (GUI_ARRAY_AddItem(&pRow->CellArray, NULL, sizeof(LISTVIEW_CELL))) {
00005e  2204              MOVS     r2,#4
000060  2100              MOVS     r1,#0
000062  f7fffffe          BL       GUI_ARRAY_AddItem
000066  b108              CBZ      r0,|L1.108|
;;;990              r = 1;
000068  2701              MOVS     r7,#1
;;;991              break;
00006a  e006              B        |L1.122|
                  |L1.108|
;;;992            }
;;;993            pObj = LISTVIEW_H2P(hObj); /* Restore after allocating memory */
00006c  4640              MOV      r0,r8
00006e  f7fffffe          BL       GUI_ALLOC_h2p
000072  4605              MOV      r5,r0
000074  1c64              ADDS     r4,r4,#1
                  |L1.118|
000076  42b4              CMP      r4,r6                 ;987
000078  d3ec              BCC      |L1.84|
                  |L1.122|
;;;994          }
;;;995        }
;;;996        LISTVIEW__UpdateScrollParas(hObj, pObj);
00007a  4629              MOV      r1,r5
00007c  4640              MOV      r0,r8
00007e  f7fffffe          BL       LISTVIEW__UpdateScrollParas
;;;997        LISTVIEW__InvalidateInsideArea(hObj, pObj);
000082  4629              MOV      r1,r5
000084  4640              MOV      r0,r8
000086  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
                  |L1.138|
;;;998        WM_UNLOCK();
;;;999      }
;;;1000     return r;
00008a  4638              MOV      r0,r7
;;;1001   }
00008c  e8bd87fc          POP      {r2-r10,pc}
;;;1002   
                          ENDP


                          AREA ||i.LISTVIEW_AddRow||, CODE, READONLY, ALIGN=1

                  LISTVIEW_AddRow PROC
;;;1006   */
;;;1007   int LISTVIEW_AddRow(LISTVIEW_Handle hObj, const GUI_ConstString* ppText) {
000000  e92d4ff3          PUSH     {r0,r1,r4-r11,lr}
000004  b081              SUB      sp,sp,#4
000006  460d              MOV      r5,r1
000008  9801              LDR      r0,[sp,#4]
;;;1008     int r = 0;
00000a  2700              MOVS     r7,#0
00000c  b140              CBZ      r0,|L2.32|
;;;1009     if (hObj) {
;;;1010       LISTVIEW_Obj* pObj;
;;;1011       WM_LOCK();
;;;1012       pObj = LISTVIEW_H2P(hObj);
00000e  f7fffffe          BL       GUI_ALLOC_h2p
;;;1013       /* Add row item to the GUI_ARRAY */
;;;1014       if (GUI_ARRAY_AddItem(&pObj->RowArray, NULL, sizeof(LISTVIEW_ROW)) == 0) {
000012  220c              MOVS     r2,#0xc
000014  2100              MOVS     r1,#0
000016  302a              ADDS     r0,r0,#0x2a
000018  f7fffffe          BL       GUI_ARRAY_AddItem
00001c  b118              CBZ      r0,|L2.38|
;;;1015         LISTVIEW_ROW* pRow;
;;;1016         int i, RowIndex, NumColumns, NumBytes;
;;;1017         const char* s;
;;;1018         pObj       = LISTVIEW_H2P(hObj);                                         /* Restore after allocating memory */
;;;1019         RowIndex   = LISTVIEW__GetNumRows(pObj) - 1;
;;;1020         NumColumns = LISTVIEW__GetNumColumns(pObj);
;;;1021         pRow       = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, RowIndex);
;;;1022         GUI_ARRAY_CREATE(&pRow->CellArray);
;;;1023         /* Add columns for the new row */
;;;1024         for (i = 0; i < NumColumns; i++) {
;;;1025           LISTVIEW_CELL* pCell;
;;;1026           s = (ppText) ? *ppText++ : 0;
;;;1027           if (s == 0) {
;;;1028             ppText = 0;
;;;1029           }
;;;1030           NumBytes = GUI__strlen(s) + 1;     /* 0 if no string is specified (s == NULL) */
;;;1031           if (GUI_ARRAY_AddItem(&pRow->CellArray, NULL, sizeof(LISTVIEW_CELL) + NumBytes)) {
;;;1032             r = 1;
;;;1033             break;
;;;1034           }
;;;1035           pObj  = LISTVIEW_H2P(hObj);                                            /* Restore after allocating memory */
;;;1036           pRow  = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, RowIndex); /* Restore after allocating memory */
;;;1037           pCell = (LISTVIEW_CELL*) GUI_ARRAY_GetpItem(&pRow->CellArray, i);
;;;1038           if (NumBytes > 1) {
;;;1039             strcpy(pCell->acText, s);
;;;1040           }
;;;1041         }
;;;1042         pObj->IsSorted = 0;
;;;1043         LISTVIEW__UpdateScrollParas(hObj, pObj);
;;;1044         if (pObj->hSort && (pObj->SortIndex >= 0)) {
;;;1045           LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;1046         } else {
;;;1047           LISTVIEW__InvalidateRow(hObj, pObj, RowIndex);
;;;1048         }
;;;1049       } else {
;;;1050         r = 1;
00001e  2701              MOVS     r7,#1
                  |L2.32|
;;;1051       }
;;;1052       WM_UNLOCK();
;;;1053     }
;;;1054     return r;
000020  4638              MOV      r0,r7
;;;1055   }
000022  e8bd8ffe          POP      {r1-r11,pc}
                  |L2.38|
000026  9801              LDR      r0,[sp,#4]            ;1018
000028  f7fffffe          BL       GUI_ALLOC_h2p
00002c  4604              MOV      r4,r0                 ;1018
00002e  f7fffffe          BL       LISTVIEW__GetNumRows
000032  1e40              SUBS     r0,r0,#1              ;1019
000034  9000              STR      r0,[sp,#0]            ;1020
000036  4620              MOV      r0,r4                 ;1020
000038  f7fffffe          BL       LISTVIEW__GetNumColumns
00003c  4682              MOV      r10,r0                ;1020
00003e  f104002a          ADD      r0,r4,#0x2a           ;1021
000042  9900              LDR      r1,[sp,#0]            ;1021
000044  f7fffffe          BL       GUI_ARRAY_GetpItem
000048  4681              MOV      r9,r0                 ;1021
00004a  2600              MOVS     r6,#0                 ;1024
00004c  e028              B        |L2.160|
                  |L2.78|
00004e  b125              CBZ      r5,|L2.90|
000050  cd01              LDM      r5!,{r0}              ;1026
000052  ea5f0b00          MOVS     r11,r0                ;1026
000056  d002              BEQ      |L2.94|
000058  e002              B        |L2.96|
                  |L2.90|
00005a  2000              MOVS     r0,#0                 ;1026
00005c  4683              MOV      r11,r0                ;1026
                  |L2.94|
00005e  2500              MOVS     r5,#0                 ;1028
                  |L2.96|
000060  f7fffffe          BL       GUI__strlen
000064  f1000801          ADD      r8,r0,#1              ;1030
000068  1d42              ADDS     r2,r0,#5              ;1031
00006a  2100              MOVS     r1,#0                 ;1031
00006c  4648              MOV      r0,r9                 ;1031
00006e  f7fffffe          BL       GUI_ARRAY_AddItem
000072  b108              CBZ      r0,|L2.120|
000074  2701              MOVS     r7,#1                 ;1032
000076  e015              B        |L2.164|
                  |L2.120|
000078  9801              LDR      r0,[sp,#4]            ;1035
00007a  f7fffffe          BL       GUI_ALLOC_h2p
00007e  4604              MOV      r4,r0                 ;1035
000080  302a              ADDS     r0,r0,#0x2a           ;1036
000082  9900              LDR      r1,[sp,#0]            ;1036
000084  f7fffffe          BL       GUI_ARRAY_GetpItem
000088  4681              MOV      r9,r0                 ;1036
00008a  4631              MOV      r1,r6                 ;1037
00008c  f7fffffe          BL       GUI_ARRAY_GetpItem
000090  f1b80f01          CMP      r8,#1                 ;1038
000094  dd03              BLE      |L2.158|
000096  4659              MOV      r1,r11                ;1039
000098  1c80              ADDS     r0,r0,#2              ;1039
00009a  f7fffffe          BL       strcpy
                  |L2.158|
00009e  1c76              ADDS     r6,r6,#1              ;1039
                  |L2.160|
0000a0  4556              CMP      r6,r10                ;1024
0000a2  dbd4              BLT      |L2.78|
                  |L2.164|
0000a4  2000              MOVS     r0,#0                 ;1042
0000a6  f8840094          STRB     r0,[r4,#0x94]         ;1042
0000aa  4621              MOV      r1,r4                 ;1043
0000ac  9801              LDR      r0,[sp,#4]            ;1043
0000ae  f7fffffe          BL       LISTVIEW__UpdateScrollParas
0000b2  f8b40092          LDRH     r0,[r4,#0x92]         ;1044
0000b6  b138              CBZ      r0,|L2.200|
0000b8  6ea0              LDR      r0,[r4,#0x68]         ;1044
0000ba  2800              CMP      r0,#0                 ;1044
0000bc  db04              BLT      |L2.200|
0000be  4621              MOV      r1,r4                 ;1045
0000c0  9801              LDR      r0,[sp,#4]            ;1045
0000c2  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
0000c6  e7ab              B        |L2.32|
                  |L2.200|
0000c8  e9dd2000          LDRD     r2,r0,[sp,#0]         ;1047
0000cc  4621              MOV      r1,r4                 ;1047
0000ce  f7fffffe          BL       LISTVIEW__InvalidateRow
0000d2  e7a5              B        |L2.32|
;;;1056   
                          ENDP


                          AREA ||i.LISTVIEW_Callback||, CODE, READONLY, ALIGN=1

                  LISTVIEW_Callback PROC
;;;772    */
;;;773    void LISTVIEW_Callback (WM_MESSAGE *pMsg) {
000000  b5fe              PUSH     {r1-r7,lr}
;;;774      LISTVIEW_Handle hObj;
;;;775      LISTVIEW_Obj* pObj;
;;;776      WM_SCROLL_STATE ScrollState;
;;;777      hObj = pMsg->hWin;
000002  f9b07004          LDRSH    r7,[r0,#4]
000006  4605              MOV      r5,r0                 ;773
;;;778      /* Let widget handle the standard messages */
;;;779      if (WIDGET_HandleActive(hObj, pMsg) == 0) {
000008  4601              MOV      r1,r0
00000a  4638              MOV      r0,r7
00000c  f7fffffe          BL       WIDGET_HandleActive
000010  2800              CMP      r0,#0
000012  d01d              BEQ      |L3.80|
;;;780        return;
;;;781      }
;;;782      pObj = (LISTVIEW_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
000014  4638              MOV      r0,r7
000016  f7fffffe          BL       GUI_ALLOC_h2p
00001a  4604              MOV      r4,r0
;;;783      switch (pMsg->MsgId) {
00001c  6828              LDR      r0,[r5,#0]
00001e  280e              CMP      r0,#0xe
000020  d07e              BEQ      |L3.288|
000022  dc06              BGT      |L3.50|
000024  2805              CMP      r0,#5
000026  d00b              BEQ      |L3.64|
000028  280b              CMP      r0,#0xb
00002a  d07a              BEQ      |L3.290|
00002c  280c              CMP      r0,#0xc
00002e  d179              BNE      |L3.292|
000030  e097              B        |L3.354|
                  |L3.50|
000032  280f              CMP      r0,#0xf
000034  d077              BEQ      |L3.294|
000036  2825              CMP      r0,#0x25
000038  d002              BEQ      |L3.64|
00003a  2826              CMP      r0,#0x26
00003c  d172              BNE      |L3.292|
00003e  e008              B        |L3.82|
                  |L3.64|
;;;784      case WM_NOTIFY_CLIENTCHANGE:
;;;785      case WM_SIZE:
;;;786        if (pMsg->hWinSrc && (pMsg->hWinSrc == pObj->hHeader)) {
000040  f9b50006          LDRSH    r0,[r5,#6]
000044  2800              CMP      r0,#0
000046  d003              BEQ      |L3.80|
000048  f9b41028          LDRSH    r1,[r4,#0x28]
00004c  4288              CMP      r0,r1
00004e  d041              BEQ      |L3.212|
                  |L3.80|
;;;787          LISTVIEW__UpdateScrollParas(hObj, pObj);
;;;788        }
;;;789        return;
;;;790      case WM_NOTIFY_PARENT:
;;;791        switch (pMsg->Data.v) {
;;;792        case WM_NOTIFICATION_CHILD_DELETED:
;;;793          /* make sure we do not send any messages to the header child once it has been deleted */
;;;794          if (pMsg->hWinSrc == pObj->hHeader) {
;;;795            pObj->hHeader = 0;
;;;796          }
;;;797          break;
;;;798        case WM_NOTIFICATION_VALUE_CHANGED:
;;;799          if (pMsg->hWinSrc == WM_GetScrollbarV(hObj)) {
;;;800            WM_GetScrollState(pMsg->hWinSrc, &ScrollState);
;;;801            pObj->ScrollStateV.v = ScrollState.v;
;;;802            LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;803            _NotifyOwner(hObj, WM_NOTIFICATION_SCROLL_CHANGED);
;;;804          } else if (pMsg->hWinSrc == WM_GetScrollbarH(hObj)) {
;;;805            WM_GetScrollState(pMsg->hWinSrc, &ScrollState);
;;;806            pObj->ScrollStateH.v = ScrollState.v;
;;;807            LISTVIEW__UpdateScrollParas(hObj, pObj);
;;;808            HEADER_SetScrollPos(pObj->hHeader, pObj->ScrollStateH.v);
;;;809            _NotifyOwner(hObj, WM_NOTIFICATION_SCROLL_CHANGED);
;;;810          }
;;;811          break;
;;;812        case WM_NOTIFICATION_SCROLLBAR_ADDED:
;;;813          #if WIDGET_USE_PARENT_EFFECT
;;;814            WIDGET_SetEffect(pMsg->hWinSrc, pObj->Widget.pEffect);
;;;815          #endif
;;;816          LISTVIEW__UpdateScrollParas(hObj, pObj);
;;;817          break;
;;;818        case WM_NOTIFICATION_RELEASED:
;;;819          if ((pMsg->hWinSrc == pObj->hHeader) && (pObj->hSort)) {
;;;820            int Column;
;;;821            LISTVIEW_SORT * pSort;
;;;822            LISTVIEW_COLUMN * pColumn;
;;;823            WM_SetFocus(hObj);
;;;824            Column = HEADER_GetSel(pObj->hHeader);
;;;825            if (Column >= 0) {
;;;826              pColumn = (LISTVIEW_COLUMN *)GUI_ARRAY_GetpItem(&pObj->ColumnArray, Column);
;;;827              if (pColumn->fpCompare) {
;;;828                pSort = (LISTVIEW_SORT *)GUI_ALLOC_h2p(pObj->hSort);
;;;829                if (pSort) {
;;;830                  // ReverseSort
;;;831                  if (pObj->SortIndex == Column) {
;;;832                    pSort->Reverse   ^= 1;
;;;833                    pObj->ReverseSort = 1;
;;;834                    pObj->IsSorted    = 0;
;;;835                  } else {
;;;836                    pSort->Reverse    = 0;
;;;837                    pObj->SortIndex   = Column;
;;;838                    pObj->IsPresorted = 0;
;;;839                  }
;;;840                  /*
;;;841                  if (pObj->SortIndex == Column) {
;;;842                    pSort->Reverse ^= 1;
;;;843                  } else {
;;;844                    pSort->Reverse = 0;
;;;845                    pObj->SortIndex = Column;
;;;846                  }
;;;847                  pObj->IsPresorted = 0;
;;;848                  */
;;;849                  LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;850                }
;;;851              }
;;;852            }
;;;853          }
;;;854          break;
;;;855        }
;;;856        return;
;;;857      case WM_PAINT:
;;;858        _Paint(hObj, pObj, pMsg);
;;;859        return;
;;;860      case WM_TOUCH:
;;;861        _OnTouch(hObj, pObj, pMsg);
;;;862        return;        /* Important: message handled ! */
;;;863      case WM_KEY:
;;;864        if (((const WM_KEY_INFO*)(pMsg->Data.p))->PressedCnt > 0) {
;;;865          int Key;
;;;866          Key = ((const WM_KEY_INFO*)(pMsg->Data.p))->Key;
;;;867          if (_AddKey(hObj, pObj, Key)) {
;;;868            return;
;;;869          }
;;;870        }
;;;871        break;  /* No return here ... WM_DefaultProc needs to be called */
;;;872      case WM_DELETE:
;;;873        _FreeAttached(pObj);
;;;874        break;  /* No return here ... WM_DefaultProc needs to be called */
;;;875      }
;;;876      WM_DefaultProc(pMsg);
;;;877    }
000050  bdfe              POP      {r1-r7,pc}
                  |L3.82|
000052  68a8              LDR      r0,[r5,#8]            ;791
000054  2600              MOVS     r6,#0                 ;791
000056  2802              CMP      r0,#2                 ;791
000058  d041              BEQ      |L3.222|
00005a  2805              CMP      r0,#5                 ;791
00005c  d00b              BEQ      |L3.118|
00005e  2806              CMP      r0,#6                 ;791
000060  d038              BEQ      |L3.212|
000062  2807              CMP      r0,#7                 ;791
000064  d1f4              BNE      |L3.80|
000066  f9b50006          LDRSH    r0,[r5,#6]            ;794
00006a  f9b41028          LDRSH    r1,[r4,#0x28]         ;794
00006e  4288              CMP      r0,r1                 ;794
000070  d1ee              BNE      |L3.80|
000072  8526              STRH     r6,[r4,#0x28]         ;795
                  |L3.116|
000074  bdfe              POP      {r1-r7,pc}
                  |L3.118|
000076  4638              MOV      r0,r7                 ;799
000078  f7fffffe          BL       WM_GetScrollbarV
00007c  4601              MOV      r1,r0                 ;799
00007e  f9b50006          LDRSH    r0,[r5,#6]            ;799
000082  4281              CMP      r1,r0                 ;799
000084  d109              BNE      |L3.154|
000086  4669              MOV      r1,sp                 ;800
000088  f7fffffe          BL       WM_GetScrollState
00008c  9801              LDR      r0,[sp,#4]            ;801
00008e  67e0              STR      r0,[r4,#0x7c]         ;802
000090  4621              MOV      r1,r4                 ;802
000092  4638              MOV      r0,r7                 ;802
000094  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
000098  e017              B        |L3.202|
                  |L3.154|
00009a  4638              MOV      r0,r7                 ;804
00009c  f7fffffe          BL       WM_GetScrollbarH
0000a0  4601              MOV      r1,r0                 ;804
0000a2  f9b50006          LDRSH    r0,[r5,#6]            ;804
0000a6  4281              CMP      r1,r0                 ;804
0000a8  d1e4              BNE      |L3.116|
0000aa  4669              MOV      r1,sp                 ;805
0000ac  f7fffffe          BL       WM_GetScrollState
0000b0  9801              LDR      r0,[sp,#4]            ;806
0000b2  f8c40088          STR      r0,[r4,#0x88]         ;807
0000b6  4621              MOV      r1,r4                 ;807
0000b8  4638              MOV      r0,r7                 ;807
0000ba  f7fffffe          BL       LISTVIEW__UpdateScrollParas
0000be  f9b40028          LDRSH    r0,[r4,#0x28]         ;808
0000c2  f8d41088          LDR      r1,[r4,#0x88]         ;808
0000c6  f7fffffe          BL       HEADER_SetScrollPos
                  |L3.202|
0000ca  210a              MOVS     r1,#0xa               ;803
                  |L3.204|
0000cc  4638              MOV      r0,r7                 ;803
0000ce  f7fffffe          BL       _NotifyOwner
0000d2  bdfe              POP      {r1-r7,pc}
                  |L3.212|
0000d4  4621              MOV      r1,r4                 ;816
0000d6  4638              MOV      r0,r7                 ;816
0000d8  f7fffffe          BL       LISTVIEW__UpdateScrollParas
                  |L3.220|
0000dc  bdfe              POP      {r1-r7,pc}
                  |L3.222|
0000de  f9b50006          LDRSH    r0,[r5,#6]            ;819
0000e2  f9b41028          LDRSH    r1,[r4,#0x28]         ;819
0000e6  4288              CMP      r0,r1                 ;819
0000e8  d1f8              BNE      |L3.220|
0000ea  f8b40092          LDRH     r0,[r4,#0x92]         ;819
0000ee  2800              CMP      r0,#0                 ;819
0000f0  d0f4              BEQ      |L3.220|
0000f2  4638              MOV      r0,r7                 ;823
0000f4  f7fffffe          BL       WM_SetFocus
0000f8  f9b40028          LDRSH    r0,[r4,#0x28]         ;824
0000fc  f7fffffe          BL       HEADER_GetSel
000100  0005              MOVS     r5,r0                 ;824
000102  d4eb              BMI      |L3.220|
000104  4601              MOV      r1,r0                 ;826
000106  f104002e          ADD      r0,r4,#0x2e           ;826
00010a  f7fffffe          BL       GUI_ARRAY_GetpItem
00010e  6840              LDR      r0,[r0,#4]            ;827
000110  2800              CMP      r0,#0                 ;827
000112  d0e3              BEQ      |L3.220|
000114  f9b40092          LDRSH    r0,[r4,#0x92]         ;828
000118  f7fffffe          BL       GUI_ALLOC_h2p
00011c  2800              CMP      r0,#0                 ;829
00011e  e003              B        |L3.296|
                  |L3.288|
000120  e031              B        |L3.390|
                  |L3.290|
000122  e03c              B        |L3.414|
                  |L3.292|
000124  e03a              B        |L3.412|
                  |L3.294|
000126  e016              B        |L3.342|
                  |L3.296|
000128  d0d8              BEQ      |L3.220|
00012a  6ea1              LDR      r1,[r4,#0x68]         ;831
00012c  42a9              CMP      r1,r5                 ;831
00012e  d109              BNE      |L3.324|
000130  7b01              LDRB     r1,[r0,#0xc]          ;832
000132  f0810101          EOR      r1,r1,#1              ;832
000136  7301              STRB     r1,[r0,#0xc]          ;832
000138  2001              MOVS     r0,#1                 ;833
00013a  f8840096          STRB     r0,[r4,#0x96]         ;833
00013e  f8846094          STRB     r6,[r4,#0x94]         ;834
000142  e003              B        |L3.332|
                  |L3.324|
000144  7306              STRB     r6,[r0,#0xc]          ;836
000146  66a5              STR      r5,[r4,#0x68]         ;838
000148  f8846095          STRB     r6,[r4,#0x95]         ;838
                  |L3.332|
00014c  4621              MOV      r1,r4                 ;849
00014e  4638              MOV      r0,r7                 ;849
000150  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
000154  bdfe              POP      {r1-r7,pc}
                  |L3.342|
000156  462a              MOV      r2,r5                 ;858
000158  4621              MOV      r1,r4                 ;858
00015a  4638              MOV      r0,r7                 ;858
00015c  f7fffffe          BL       _Paint
                  |L3.352|
000160  bdfe              POP      {r1-r7,pc}
                  |L3.354|
000162  68aa              LDR      r2,[r5,#8]
000164  4621              MOV      r1,r4                 ;861
000166  b15a              CBZ      r2,|L3.384|
000168  7a10              LDRB     r0,[r2,#8]            ;861
00016a  b138              CBZ      r0,|L3.380|
00016c  4638              MOV      r0,r7                 ;861
00016e  f7fffffe          BL       _SetSelFromPos
000172  2401              MOVS     r4,#1                 ;861
000174  4638              MOV      r0,r7                 ;861
000176  f7fffffe          BL       WM_SetFocus
00017a  e002              B        |L3.386|
                  |L3.380|
00017c  2402              MOVS     r4,#2                 ;861
00017e  e000              B        |L3.386|
                  |L3.384|
000180  2403              MOVS     r4,#3                 ;861
                  |L3.386|
000182  4621              MOV      r1,r4                 ;861
000184  e7a2              B        |L3.204|
                  |L3.390|
000186  68a8              LDR      r0,[r5,#8]            ;864
000188  6841              LDR      r1,[r0,#4]            ;864
00018a  2900              CMP      r1,#0                 ;864
00018c  dd0a              BLE      |L3.420|
00018e  6802              LDR      r2,[r0,#0]            ;867
000190  4621              MOV      r1,r4                 ;867
000192  4638              MOV      r0,r7                 ;867
000194  f7fffffe          BL       _AddKey
000198  2800              CMP      r0,#0                 ;867
00019a  d1e1              BNE      |L3.352|
                  |L3.412|
00019c  e002              B        |L3.420|
                  |L3.414|
00019e  4620              MOV      r0,r4                 ;873
0001a0  f7fffffe          BL       _FreeAttached
                  |L3.420|
0001a4  4628              MOV      r0,r5                 ;876
0001a6  f7fffffe          BL       WM_DefaultProc
0001aa  bdfe              POP      {r1-r7,pc}
;;;878    
                          ENDP


                          AREA ||i.LISTVIEW_CreateEx||, CODE, READONLY, ALIGN=2

                  LISTVIEW_CreateEx PROC
;;;892    */
;;;893    LISTVIEW_Handle LISTVIEW_CreateEx(int x0, int y0, int xsize, int ysize, WM_HWIN hParent,
000000  e92d41ff          PUSH     {r0-r8,lr}
;;;894                                      int WinFlags, int ExFlags, int Id)
;;;895    {
000004  4606              MOV      r6,r0
000006  e9dd470a          LDRD     r4,r7,[sp,#0x28]
;;;896      LISTVIEW_Handle hObj;
;;;897      GUI_USE_PARA(ExFlags);
;;;898      WM_LOCK();
;;;899      /* Create the window */
;;;900      if ((xsize == 0) && (ysize == 0) && (x0 == 0) && (y0 == 0)) {
00000a  ea420003          ORR      r0,r2,r3
00000e  460d              MOV      r5,r1                 ;895
000010  4330              ORRS     r0,r0,r6
000012  f8dd8034          LDR      r8,[sp,#0x34]
000016  4328              ORRS     r0,r0,r5
000018  d10f              BNE      |L4.58|
;;;901        GUI_RECT Rect;
;;;902        WM_GetClientRectEx(hParent, &Rect);
00001a  4669              MOV      r1,sp
00001c  4620              MOV      r0,r4
00001e  f7fffffe          BL       WM_GetClientRectEx
;;;903        xsize = Rect.x1 - Rect.x0 + 1;
000022  f9bd0004          LDRSH    r0,[sp,#4]
000026  f9bd1000          LDRSH    r1,[sp,#0]
00002a  1a42              SUBS     r2,r0,r1
;;;904        ysize = Rect.y1 - Rect.y0 + 1;
00002c  f9bd0006          LDRSH    r0,[sp,#6]
000030  f9bd1002          LDRSH    r1,[sp,#2]
000034  1c52              ADDS     r2,r2,#1
000036  1a43              SUBS     r3,r0,r1
000038  1c5b              ADDS     r3,r3,#1
                  |L4.58|
;;;905      }
;;;906      hObj = WM_CreateWindowAsChild(x0, y0, xsize, ysize, hParent, WinFlags, &LISTVIEW_Callback,
00003a  2178              MOVS     r1,#0x78
00003c  f8dfc068          LDR      r12,|L4.168|
000040  b2b8              UXTH     r0,r7
000042  e9cdc102          STRD     r12,r1,[sp,#8]
000046  e9cd4000          STRD     r4,r0,[sp,#0]
00004a  4629              MOV      r1,r5
00004c  4630              MOV      r0,r6
00004e  f7fffffe          BL       WM_CreateWindowAsChild
000052  0005              MOVS     r5,r0
;;;907                                    sizeof(LISTVIEW_Obj) - sizeof(WM_Obj));
;;;908      if (hObj) {
000054  d023              BEQ      |L4.158|
;;;909        LISTVIEW_Obj* pObj;
;;;910        pObj = (LISTVIEW_Obj *)GUI_ALLOC_h2p(hObj); /* Don't use use WIDGET_H2P because WIDGET_INIT_ID() has not be called at this point */
000056  f7fffffe          BL       GUI_ALLOC_h2p
00005a  4604              MOV      r4,r0
;;;911        /* Init sub-classes */
;;;912        GUI_ARRAY_CREATE(&pObj->RowArray);
;;;913        GUI_ARRAY_CREATE(&pObj->ColumnArray);
;;;914        /* Init widget specific variables */
;;;915        WIDGET__Init(&pObj->Widget, Id, WIDGET_STATE_FOCUSSABLE);
00005c  2210              MOVS     r2,#0x10
00005e  4641              MOV      r1,r8
000060  f7fffffe          BL       WIDGET__Init
;;;916        /* Init member variables */
;;;917        LISTVIEW_INIT_ID(pObj);
;;;918        pObj->Props     = LISTVIEW_DefaultProps;
000064  222c              MOVS     r2,#0x2c
000066  4911              LDR      r1,|L4.172|
000068  f1040034          ADD      r0,r4,#0x34
00006c  f7fffffe          BL       __aeabi_memcpy4
;;;919        pObj->ShowGrid  = 0;
000070  2100              MOVS     r1,#0
;;;920        pObj->RowDistY  = 0;
;;;921        pObj->Sel       = -1;
000072  1e48              SUBS     r0,r1,#1
;;;922        pObj->LBorder   = 1;
000074  e9c40118          STRD     r0,r1,[r4,#0x60]
000078  2201              MOVS     r2,#1
00007a  e9c4121b          STRD     r1,r2,[r4,#0x6c]
;;;923        pObj->RBorder   = 1;
;;;924        pObj->hHeader   = HEADER_CreateEx(0, 0, 0, 0, hObj, WM_CF_SHOW, 0, 0);
00007e  6762              STR      r2,[r4,#0x74]
000080  2002              MOVS     r0,#2
000082  9500              STR      r5,[sp,#0]
000084  e9cd0101          STRD     r0,r1,[sp,#4]
000088  460b              MOV      r3,r1
00008a  460a              MOV      r2,r1
00008c  4608              MOV      r0,r1
00008e  9103              STR      r1,[sp,#0xc]
000090  f7fffffe          BL       HEADER_CreateEx
000094  8520              STRH     r0,[r4,#0x28]
;;;925        LISTVIEW__UpdateScrollParas(hObj, pObj);
000096  4621              MOV      r1,r4
000098  4628              MOV      r0,r5
00009a  f7fffffe          BL       LISTVIEW__UpdateScrollParas
                  |L4.158|
;;;926      } else {
;;;927        GUI_DEBUG_ERROROUT_IF(hObj==0, "LISTVIEW_Create failed")
;;;928      }
;;;929      WM_UNLOCK();
;;;930      return hObj;
;;;931    }
00009e  b004              ADD      sp,sp,#0x10
0000a0  4628              MOV      r0,r5                 ;930
0000a2  e8bd81f0          POP      {r4-r8,pc}
;;;932    
                          ENDP

0000a6  0000              DCW      0x0000
                  |L4.168|
                          DCD      LISTVIEW_Callback
                  |L4.172|
                          DCD      ||.data||

                          AREA ||i.LISTVIEW_DecSel||, CODE, READONLY, ALIGN=1

                  LISTVIEW_DecSel PROC
;;;956    */
;;;957    void LISTVIEW_DecSel(LISTVIEW_Handle hObj) {
000000  b510              PUSH     {r4,lr}
000002  0004              MOVS     r4,r0
000004  d009              BEQ      |L5.26|
;;;958      if (hObj) {
;;;959        LISTVIEW_Obj* pObj;
;;;960        WM_LOCK();
;;;961        pObj = LISTVIEW_H2P(hObj);
000006  f7fffffe          BL       GUI_ALLOC_h2p
00000a  4601              MOV      r1,r0
;;;962        LISTVIEW__MoveSel(hObj, pObj, -1);
00000c  4620              MOV      r0,r4
00000e  e8bd4010          POP      {r4,lr}
000012  f04f32ff          MOV      r2,#0xffffffff
000016  f7ffbffe          B.W      LISTVIEW__MoveSel
                  |L5.26|
;;;963        WM_UNLOCK();
;;;964      }
;;;965    }
00001a  bd10              POP      {r4,pc}
;;;966    
                          ENDP


                          AREA ||i.LISTVIEW_IncSel||, CODE, READONLY, ALIGN=1

                  LISTVIEW_IncSel PROC
;;;942    */
;;;943    void LISTVIEW_IncSel(LISTVIEW_Handle hObj) {
000000  b510              PUSH     {r4,lr}
000002  0004              MOVS     r4,r0
000004  d008              BEQ      |L6.24|
;;;944      if (hObj) {
;;;945        LISTVIEW_Obj* pObj;
;;;946        WM_LOCK();
;;;947        pObj = LISTVIEW_H2P(hObj);
000006  f7fffffe          BL       GUI_ALLOC_h2p
00000a  4601              MOV      r1,r0
;;;948        LISTVIEW__MoveSel(hObj, pObj, 1);
00000c  4620              MOV      r0,r4
00000e  e8bd4010          POP      {r4,lr}
000012  2201              MOVS     r2,#1
000014  f7ffbffe          B.W      LISTVIEW__MoveSel
                  |L6.24|
;;;949        WM_UNLOCK();
;;;950      }
;;;951    }
000018  bd10              POP      {r4,pc}
;;;952    
                          ENDP


                          AREA ||i.LISTVIEW__GetNumColumns||, CODE, READONLY, ALIGN=1

                  LISTVIEW__GetNumColumns PROC
;;;134    */
;;;135    unsigned LISTVIEW__GetNumColumns(LISTVIEW_Obj* pObj) {
000000  302e              ADDS     r0,r0,#0x2e
;;;136      return GUI_ARRAY_GetNumItems(&pObj->ColumnArray);
000002  f7ffbffe          B.W      GUI_ARRAY_GetNumItems
;;;137    }
;;;138    
                          ENDP


                          AREA ||i.LISTVIEW__GetNumRows||, CODE, READONLY, ALIGN=1

                  LISTVIEW__GetNumRows PROC
;;;126    */
;;;127    unsigned LISTVIEW__GetNumRows(LISTVIEW_Obj* pObj) {
000000  302a              ADDS     r0,r0,#0x2a
;;;128      return GUI_ARRAY_GetNumItems(&pObj->RowArray);
000002  f7ffbffe          B.W      GUI_ARRAY_GetNumItems
;;;129    }
;;;130    
                          ENDP


                          AREA ||i.LISTVIEW__GetRowDistY||, CODE, READONLY, ALIGN=1

                  LISTVIEW__GetRowDistY PROC
;;;213    */
;;;214    unsigned LISTVIEW__GetRowDistY(const LISTVIEW_Obj* pObj) {
000000  b510              PUSH     {r4,lr}
000002  4604              MOV      r4,r0
;;;215      unsigned RowDistY;
;;;216      if (pObj->RowDistY) {
000004  6ec0              LDR      r0,[r0,#0x6c]
000006  2800              CMP      r0,#0                 ;214
000008  d106              BNE      |L9.24|
;;;217        RowDistY = pObj->RowDistY;
;;;218      } else {
;;;219        RowDistY = GUI_GetYDistOfFont(pObj->Props.pFont);
00000a  6da0              LDR      r0,[r4,#0x58]
00000c  f7fffffe          BL       GUI_GetYDistOfFont
;;;220        if (pObj->ShowGrid) {
000010  6e61              LDR      r1,[r4,#0x64]
000012  2900              CMP      r1,#0
000014  d000              BEQ      |L9.24|
000016  1c40              ADDS     r0,r0,#1
                  |L9.24|
;;;221          RowDistY++;
;;;222        }
;;;223      }
;;;224      return RowDistY;
;;;225    }
000018  bd10              POP      {r4,pc}
;;;226    
                          ENDP


                          AREA ||i.LISTVIEW__GetSel||, CODE, READONLY, ALIGN=1

                  LISTVIEW__GetSel PROC
;;;142    */
;;;143    int LISTVIEW__GetSel(LISTVIEW_Obj* pObj) {
000000  6e00              LDR      r0,[r0,#0x60]
;;;144      return pObj->Sel;
;;;145    }
000002  4770              BX       lr
;;;146    
                          ENDP


                          AREA ||i.LISTVIEW__InvalidateInsideArea||, CODE, READONLY, ALIGN=1

                  LISTVIEW__InvalidateInsideArea PROC
;;;422    */
;;;423    void LISTVIEW__InvalidateInsideArea(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj) {
000000  b57c              PUSH     {r2-r6,lr}
000002  4605              MOV      r5,r0
;;;424      GUI_RECT Rect;
;;;425      int HeaderHeight;
;;;426      HeaderHeight = HEADER_GetHeight(pObj->hHeader);
000004  f9b10028          LDRSH    r0,[r1,#0x28]
000008  f7fffffe          BL       HEADER_GetHeight
00000c  4604              MOV      r4,r0
;;;427      WM_GetInsideRectExScrollbar(hObj, &Rect);
00000e  4669              MOV      r1,sp
000010  4628              MOV      r0,r5
000012  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;428      Rect.y0 += HeaderHeight;
000016  f8bd0002          LDRH     r0,[sp,#2]
;;;429      WM_InvalidateRect(hObj, &Rect);
00001a  4669              MOV      r1,sp
00001c  4420              ADD      r0,r0,r4              ;428
00001e  f8ad0002          STRH     r0,[sp,#2]            ;428
000022  4628              MOV      r0,r5
000024  f7fffffe          BL       WM_InvalidateRect
;;;430    }
000028  bd7c              POP      {r2-r6,pc}
;;;431    
                          ENDP


                          AREA ||i.LISTVIEW__InvalidateRow||, CODE, READONLY, ALIGN=1

                  LISTVIEW__InvalidateRow PROC
;;;435    */
;;;436    void LISTVIEW__InvalidateRow(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, int Sel) {
000000  e92d41fc          PUSH     {r2-r8,lr}
000004  0015              MOVS     r5,r2
000006  460c              MOV      r4,r1
000008  4680              MOV      r8,r0
00000a  d41d              BMI      |L12.72|
;;;437      if (Sel >= 0) {
;;;438        GUI_RECT Rect;
;;;439        int HeaderHeight, RowDistY;
;;;440        HeaderHeight = HEADER_GetHeight(pObj->hHeader);
00000c  f9b40028          LDRSH    r0,[r4,#0x28]
000010  f7fffffe          BL       HEADER_GetHeight
000014  4606              MOV      r6,r0
;;;441        RowDistY     = LISTVIEW__GetRowDistY(pObj);
000016  4620              MOV      r0,r4
000018  f7fffffe          BL       LISTVIEW__GetRowDistY
00001c  4607              MOV      r7,r0
;;;442        WM_GetInsideRectExScrollbar(hObj, &Rect);
00001e  4669              MOV      r1,sp
000020  4640              MOV      r0,r8
000022  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;443        Rect.y0 += HeaderHeight + (Sel - pObj->ScrollStateV.v) * RowDistY;
000026  6fe1              LDR      r1,[r4,#0x7c]
000028  f9bd0002          LDRSH    r0,[sp,#2]
00002c  1a69              SUBS     r1,r5,r1
00002e  fb010007          MLA      r0,r1,r7,r0
000032  1981              ADDS     r1,r0,r6
000034  1e7f              SUBS     r7,r7,#1
;;;444        Rect.y1  = Rect.y0 + RowDistY - 1;
000036  19c8              ADDS     r0,r1,r7
000038  f8ad1002          STRH     r1,[sp,#2]            ;443
00003c  f8ad0006          STRH     r0,[sp,#6]
;;;445        WM_InvalidateRect(hObj, &Rect);
000040  4669              MOV      r1,sp
000042  4640              MOV      r0,r8
000044  f7fffffe          BL       WM_InvalidateRect
                  |L12.72|
;;;446      }
;;;447    }
000048  e8bd81fc          POP      {r2-r8,pc}
;;;448    
                          ENDP


                          AREA ||i.LISTVIEW__MoveSel||, CODE, READONLY, ALIGN=1

                  LISTVIEW__MoveSel PROC
;;;189    */
;;;190    void LISTVIEW__MoveSel(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, int Dir) {
000000  e92d47f0          PUSH     {r4-r10,lr}
000004  4682              MOV      r10,r0
000006  4690              MOV      r8,r2
000008  460e              MOV      r6,r1
;;;191      int Index, NewSel = -1, NumRows;
00000a  f04f35ff          MOV      r5,#0xffffffff
;;;192      Index   = LISTVIEW__GetSel(pObj);
;;;193      NumRows = LISTVIEW__GetNumRows(pObj);
00000e  4608              MOV      r0,r1
000010  6e0c              LDR      r4,[r1,#0x60]
000012  f7fffffe          BL       LISTVIEW__GetNumRows
000016  4607              MOV      r7,r0
;;;194      do {
;;;195        LISTVIEW_ROW* pRow;
;;;196        Index += Dir;
;;;197        if ((Index < 0) || (Index >= NumRows)) {
;;;198          break;
;;;199        }
;;;200        pRow = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, Index);
000018  f106092a          ADD      r9,r6,#0x2a
                  |L13.28|
00001c  eb140408          ADDS     r4,r4,r8              ;196
000020  d40b              BMI      |L13.58|
000022  42bc              CMP      r4,r7                 ;197
000024  da09              BGE      |L13.58|
000026  4621              MOV      r1,r4
000028  4648              MOV      r0,r9
00002a  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;201        if (pRow->Disabled == 0) {
00002e  7900              LDRB     r0,[r0,#4]
000030  b900              CBNZ     r0,|L13.52|
;;;202          NewSel = Index;
000032  4625              MOV      r5,r4
                  |L13.52|
;;;203        }
;;;204      } while (NewSel < 0);
000034  2d00              CMP      r5,#0
000036  dbf1              BLT      |L13.28|
000038  e001              B        |L13.62|
                  |L13.58|
;;;205      if (NewSel >= 0) {
00003a  2d00              CMP      r5,#0
00003c  db06              BLT      |L13.76|
                  |L13.62|
;;;206        LISTVIEW__SetSel(hObj, pObj, NewSel);
00003e  462a              MOV      r2,r5
000040  4631              MOV      r1,r6
000042  4650              MOV      r0,r10
000044  e8bd47f0          POP      {r4-r10,lr}
000048  f7ffbffe          B.W      LISTVIEW__SetSel
                  |L13.76|
;;;207      }
;;;208    }
00004c  e8bd87f0          POP      {r4-r10,pc}
;;;209    
                          ENDP


                          AREA ||i.LISTVIEW__SetSel||, CODE, READONLY, ALIGN=1

                  LISTVIEW__SetSel PROC
;;;150    */
;;;151    void LISTVIEW__SetSel(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, int NewSel) {
000000  e92d41f0          PUSH     {r4-r8,lr}
000004  4606              MOV      r6,r0
000006  4614              MOV      r4,r2
000008  460d              MOV      r5,r1
;;;152      int NumRows;
;;;153      NumRows = LISTVIEW__GetNumRows(pObj);
00000a  4608              MOV      r0,r1
00000c  f7fffffe          BL       LISTVIEW__GetNumRows
;;;154      if (NewSel >= NumRows) {
000010  4284              CMP      r4,r0
000012  db00              BLT      |L14.22|
000014  1e44              SUBS     r4,r0,#1
                  |L14.22|
;;;155        NewSel = NumRows - 1;
;;;156      }
;;;157      if (NewSel < 0) {
000016  2c00              CMP      r4,#0
000018  da01              BGE      |L14.30|
;;;158        NewSel = -1;
00001a  f04f34ff          MOV      r4,#0xffffffff
                  |L14.30|
;;;159      }
;;;160      if (NewSel != pObj->Sel) {
00001e  6e28              LDR      r0,[r5,#0x60]
000020  42a0              CMP      r0,r4
000022  d024              BEQ      |L14.110|
;;;161        char Disabled;
;;;162        LISTVIEW_ROW * pRow;
;;;163        pRow = (LISTVIEW_ROW *)GUI_ARRAY_GetpItem(&pObj->RowArray, NewSel);
000024  4621              MOV      r1,r4
000026  f105002a          ADD      r0,r5,#0x2a
00002a  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;164        if (pRow) {
00002e  b110              CBZ      r0,|L14.54|
;;;165          Disabled = pRow->Disabled;
000030  7900              LDRB     r0,[r0,#4]
000032  2800              CMP      r0,#0
000034  d11b              BNE      |L14.110|
                  |L14.54|
;;;166        } else {
;;;167          Disabled = 0;
;;;168        }
;;;169        if (Disabled == 0) {
;;;170          int OldSel;
;;;171          OldSel    = pObj->Sel;
;;;172          pObj->Sel = NewSel;
000036  6e2f              LDR      r7,[r5,#0x60]
;;;173          if (LISTVIEW__UpdateScrollPos(hObj, pObj)) {
000038  4629              MOV      r1,r5
00003a  4630              MOV      r0,r6
00003c  662c              STR      r4,[r5,#0x60]
00003e  f7fffffe          BL       LISTVIEW__UpdateScrollPos
000042  b120              CBZ      r0,|L14.78|
;;;174            LISTVIEW__InvalidateInsideArea(hObj, pObj);
000044  4629              MOV      r1,r5
000046  4630              MOV      r0,r6
000048  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
00004c  e009              B        |L14.98|
                  |L14.78|
;;;175          } else {
;;;176            LISTVIEW__InvalidateRow(hObj, pObj, OldSel);
00004e  463a              MOV      r2,r7
000050  4629              MOV      r1,r5
000052  4630              MOV      r0,r6
000054  f7fffffe          BL       LISTVIEW__InvalidateRow
;;;177            LISTVIEW__InvalidateRow(hObj, pObj, NewSel);
000058  4622              MOV      r2,r4
00005a  4629              MOV      r1,r5
00005c  4630              MOV      r0,r6
00005e  f7fffffe          BL       LISTVIEW__InvalidateRow
                  |L14.98|
;;;178          }
;;;179          WM_NotifyParent(hObj, WM_NOTIFICATION_SEL_CHANGED);
000062  4630              MOV      r0,r6
000064  e8bd41f0          POP      {r4-r8,lr}
000068  2104              MOVS     r1,#4
00006a  f7ffbffe          B.W      WM_NotifyParent
                  |L14.110|
;;;180        }
;;;181      }
;;;182    }
00006e  e8bd81f0          POP      {r4-r8,pc}
;;;183    
                          ENDP


                          AREA ||i.LISTVIEW__UpdateScrollParas||, CODE, READONLY, ALIGN=1

                  LISTVIEW__UpdateScrollParas PROC
;;;580    */
;;;581    int LISTVIEW__UpdateScrollParas(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj) {
000000  e92d47fc          PUSH     {r2-r10,lr}
000004  460c              MOV      r4,r1
000006  4682              MOV      r10,r0
;;;582      int NumRows, IsRequired;
;;;583      int xSize, xSizeHeader;
;;;584      unsigned NumVisibleRows;
;;;585      NumVisibleRows = _GetNumVisibleRows(hObj, pObj);
000008  f7fffffe          BL       _GetNumVisibleRows
00000c  4681              MOV      r9,r0
;;;586      xSize          = _GetXSize(hObj);
00000e  4650              MOV      r0,r10
000010  4669              MOV      r1,sp
000012  f7fffffe          BL       WM_GetInsideRectExScrollbar
000016  f9bd0004          LDRSH    r0,[sp,#4]
00001a  f9bd1000          LDRSH    r1,[sp,#0]
00001e  2501              MOVS     r5,#1
000020  1a40              SUBS     r0,r0,r1
000022  f1000801          ADD      r8,r0,#1
000026  f9b40028          LDRSH    r0,[r4,#0x28]
00002a  f7fffffe          BL       HEADER_GetNumItems
00002e  0007              MOVS     r7,r0
000030  d00b              BEQ      |L15.74|
000032  2600              MOVS     r6,#0
000034  4635              MOV      r5,r6
000036  e006              B        |L15.70|
                  |L15.56|
000038  f9b40028          LDRSH    r0,[r4,#0x28]
00003c  4631              MOV      r1,r6
00003e  f7fffffe          BL       HEADER_GetItemWidth
000042  4405              ADD      r5,r5,r0
000044  1c76              ADDS     r6,r6,#1
                  |L15.70|
000046  42be              CMP      r6,r7
000048  dbf6              BLT      |L15.56|
                  |L15.74|
;;;587      xSizeHeader    = _GetHeaderWidth(pObj);
;;;588      if (pObj->Flags & LISTVIEW_SF_AUTOSCROLLBAR_V) {
00004a  f8940097          LDRB     r0,[r4,#0x97]
00004e  0780              LSLS     r0,r0,#30
000050  d50b              BPL      |L15.106|
;;;589        IsRequired = (NumVisibleRows < GUI_ARRAY_GetNumItems(&pObj->RowArray));
000052  f104002a          ADD      r0,r4,#0x2a
000056  f7fffffe          BL       GUI_ARRAY_GetNumItems
00005a  4548              CMP      r0,r9
00005c  d901              BLS      |L15.98|
00005e  2101              MOVS     r1,#1
000060  e000              B        |L15.100|
                  |L15.98|
000062  2100              MOVS     r1,#0
                  |L15.100|
;;;590        WM_SetScrollbarV(hObj, IsRequired);
000064  4650              MOV      r0,r10
000066  f7fffffe          BL       WM_SetScrollbarV
                  |L15.106|
;;;591      }
;;;592      if (pObj->Flags & LISTVIEW_SF_AUTOSCROLLBAR_H) {
00006a  f8940097          LDRB     r0,[r4,#0x97]
00006e  07c0              LSLS     r0,r0,#31
000070  d00c              BEQ      |L15.140|
;;;593        IsRequired  = (xSizeHeader > xSize);
000072  4545              CMP      r5,r8
000074  dd01              BLE      |L15.122|
000076  2101              MOVS     r1,#1
000078  e000              B        |L15.124|
                  |L15.122|
00007a  2100              MOVS     r1,#0
                  |L15.124|
;;;594        WM_SetScrollbarH(hObj, IsRequired);
00007c  4650              MOV      r0,r10
00007e  f7fffffe          BL       WM_SetScrollbarH
;;;595        NumVisibleRows = _GetNumVisibleRows(hObj, pObj);
000082  4621              MOV      r1,r4
000084  4650              MOV      r0,r10
000086  f7fffffe          BL       _GetNumVisibleRows
00008a  4681              MOV      r9,r0
                  |L15.140|
;;;596      }
;;;597      NumRows = LISTVIEW__GetNumRows(pObj);
00008c  4620              MOV      r0,r4
00008e  f7fffffe          BL       LISTVIEW__GetNumRows
;;;598      /* update vertical scrollbar */
;;;599      pObj->ScrollStateV.PageSize = NumVisibleRows;
;;;600      pObj->ScrollStateV.NumItems = (NumRows) ? NumRows : 1;
000092  f8c49080          STR      r9,[r4,#0x80]
000096  b900              CBNZ     r0,|L15.154|
000098  2001              MOVS     r0,#1
                  |L15.154|
;;;601      /* update horizontal scrollbar */
;;;602      pObj->ScrollStateH.PageSize = xSize;
;;;603      pObj->ScrollStateH.NumItems = xSizeHeader;
;;;604      return LISTVIEW__UpdateScrollPos(hObj, pObj);
00009a  f8c4808c          STR      r8,[r4,#0x8c]
00009e  f8c45084          STR      r5,[r4,#0x84]
0000a2  67a0              STR      r0,[r4,#0x78]
0000a4  4621              MOV      r1,r4
0000a6  4650              MOV      r0,r10
0000a8  e8bd47fc          POP      {r2-r10,lr}
0000ac  f7ffbffe          B.W      LISTVIEW__UpdateScrollPos
;;;605    }
;;;606    
                          ENDP


                          AREA ||i.LISTVIEW__UpdateScrollPos||, CODE, READONLY, ALIGN=1

                  LISTVIEW__UpdateScrollPos PROC
;;;558    */
;;;559    int LISTVIEW__UpdateScrollPos(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj) {
000000  e92d41f0          PUSH     {r4-r8,lr}
000004  460c              MOV      r4,r1
;;;560      int PrevScrollStateV;
;;;561      PrevScrollStateV = pObj->ScrollStateV.v;
;;;562      if (pObj->Sel >= 0) {
000006  6fce              LDR      r6,[r1,#0x7c]
000008  6e09              LDR      r1,[r1,#0x60]
00000a  4680              MOV      r8,r0                 ;559
;;;563        WM_CheckScrollPos(&pObj->ScrollStateV, pObj->Sel, 0, 0);
00000c  f1040578          ADD      r5,r4,#0x78
000010  2900              CMP      r1,#0                 ;562
000012  db05              BLT      |L16.32|
000014  2300              MOVS     r3,#0
000016  461a              MOV      r2,r3
000018  4628              MOV      r0,r5
00001a  f7fffffe          BL       WM_CheckScrollPos
00001e  e002              B        |L16.38|
                  |L16.32|
000020  4628              MOV      r0,r5
;;;564      } else {
;;;565        WM_CheckScrollBounds(&pObj->ScrollStateV);
000022  f7fffffe          BL       WM_CheckScrollBounds
                  |L16.38|
;;;566      }
;;;567      WM_CheckScrollBounds(&pObj->ScrollStateH);
000026  f1040084          ADD      r0,r4,#0x84
00002a  4607              MOV      r7,r0
00002c  f7fffffe          BL       WM_CheckScrollBounds
000030  463a              MOV      r2,r7
000032  4629              MOV      r1,r5
;;;568      WIDGET__SetScrollState(hObj, &pObj->ScrollStateV, &pObj->ScrollStateH);
000034  4640              MOV      r0,r8
000036  f7fffffe          BL       WIDGET__SetScrollState
;;;569      return pObj->ScrollStateV.v - PrevScrollStateV;
00003a  6fe0              LDR      r0,[r4,#0x7c]
00003c  1b80              SUBS     r0,r0,r6
;;;570    }
00003e  e8bd81f0          POP      {r4-r8,pc}
;;;571    
                          ENDP


                          AREA ||i._AddKey||, CODE, READONLY, ALIGN=1

                  _AddKey PROC
;;;703    */
;;;704    static int _AddKey(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, int Key) {
000000  b570              PUSH     {r4-r6,lr}
;;;705      switch (Key) {
000002  4613              MOV      r3,r2
000004  460c              MOV      r4,r1                 ;704
000006  4605              MOV      r5,r0                 ;704
;;;706      case GUI_KEY_DOWN:
;;;707        LISTVIEW__MoveSel(hObj, pObj, 1);
;;;708        return 1;               /* Key has been consumed */
;;;709      case GUI_KEY_PGDOWN:
;;;710        _OnPage(hObj, pObj, 1);
;;;711        return 1;               /* Key has been consumed */
;;;712      case GUI_KEY_UP:
;;;713        LISTVIEW__MoveSel(hObj, pObj, -1);
000008  f04f32ff          MOV      r2,#0xffffffff
00000c  2b17              CMP      r3,#0x17              ;705
00000e  d01d              BEQ      |L17.76|
000010  dc0a              BGT      |L17.40|
;;;714        return 1;               /* Key has been consumed */
;;;715      case GUI_KEY_PGUP:
;;;716        _OnPage(hObj, pObj, -1);
;;;717        return 1;               /* Key has been consumed */
;;;718      case GUI_KEY_HOME:
;;;719        LISTVIEW__SetSel(hObj, pObj, 0);
;;;720        return 1;               /* Key has been consumed */
;;;721      case GUI_KEY_END:
;;;722        LISTVIEW__SetSel(hObj, pObj, LISTVIEW__GetNumRows(pObj) - 1);
;;;723        return 1;               /* Key has been consumed */
;;;724      case GUI_KEY_RIGHT:
;;;725        if (WM_SetScrollValue(&pObj->ScrollStateH, pObj->ScrollStateH.v + pObj->Props.ScrollStepH)) {
000012  f1040084          ADD      r0,r4,#0x84
000016  2b10              CMP      r3,#0x10              ;705
000018  d032              BEQ      |L17.128|
00001a  2b11              CMP      r3,#0x11              ;705
00001c  d00d              BEQ      |L17.58|
00001e  2b12              CMP      r3,#0x12              ;705
000020  d01f              BEQ      |L17.98|
000022  2b13              CMP      r3,#0x13              ;705
000024  d106              BNE      |L17.52|
000026  e007              B        |L17.56|
                  |L17.40|
000028  2b18              CMP      r3,#0x18              ;705
00002a  d011              BEQ      |L17.80|
00002c  2b21              CMP      r3,#0x21              ;705
00002e  d00a              BEQ      |L17.70|
000030  2b22              CMP      r3,#0x22              ;705
000032  d007              BEQ      |L17.68|
                  |L17.52|
;;;726          LISTVIEW__UpdateScrollPos(hObj, pObj);
;;;727          LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;728        }
;;;729        return 1;               /* Key has been consumed */
;;;730      case GUI_KEY_LEFT:
;;;731        if (WM_SetScrollValue(&pObj->ScrollStateH, pObj->ScrollStateH.v - pObj->Props.ScrollStepH)) {
;;;732          LISTVIEW__UpdateScrollPos(hObj, pObj);
;;;733          LISTVIEW__InvalidateInsideArea(hObj, pObj);
;;;734        }
;;;735        return 1;               /* Key has been consumed */
;;;736      }
;;;737      return 0;                 /* Key has NOT been consumed */
000034  2000              MOVS     r0,#0
;;;738    }
000036  bd70              POP      {r4-r6,pc}
                  |L17.56|
000038  2201              MOVS     r2,#1                 ;707
                  |L17.58|
00003a  4621              MOV      r1,r4                 ;713
00003c  4628              MOV      r0,r5                 ;713
00003e  f7fffffe          BL       LISTVIEW__MoveSel
000042  e026              B        |L17.146|
                  |L17.68|
000044  2201              MOVS     r2,#1                 ;710
                  |L17.70|
000046  f7fffffe          BL       _OnPage
00004a  e022              B        |L17.146|
                  |L17.76|
00004c  2200              MOVS     r2,#0                 ;719
00004e  e005              B        |L17.92|
                  |L17.80|
000050  4608              MOV      r0,r1                 ;722
000052  f7fffffe          BL       LISTVIEW__GetNumRows
000056  1e42              SUBS     r2,r0,#1              ;722
000058  4621              MOV      r1,r4                 ;722
00005a  4628              MOV      r0,r5                 ;722
                  |L17.92|
00005c  f7fffffe          BL       LISTVIEW__SetSel
000060  e017              B        |L17.146|
                  |L17.98|
000062  f8b4205c          LDRH     r2,[r4,#0x5c]         ;725
000066  f8d41088          LDR      r1,[r4,#0x88]         ;725
00006a  4411              ADD      r1,r1,r2              ;725
00006c  e00d              B        |L17.138|
                  |L17.110|
00006e  4621              MOV      r1,r4                 ;726
000070  4628              MOV      r0,r5                 ;726
000072  f7fffffe          BL       LISTVIEW__UpdateScrollPos
000076  4621              MOV      r1,r4                 ;727
000078  4628              MOV      r0,r5                 ;727
00007a  f7fffffe          BL       LISTVIEW__InvalidateInsideArea
00007e  e008              B        |L17.146|
                  |L17.128|
000080  f8b4205c          LDRH     r2,[r4,#0x5c]         ;731
000084  f8d41088          LDR      r1,[r4,#0x88]         ;731
000088  1a89              SUBS     r1,r1,r2              ;731
                  |L17.138|
00008a  f7fffffe          BL       WM_SetScrollValue
00008e  2800              CMP      r0,#0                 ;725
000090  d1ed              BNE      |L17.110|
                  |L17.146|
000092  2001              MOVS     r0,#1                 ;735
000094  bd70              POP      {r4-r6,pc}
;;;739    
                          ENDP


                          AREA ||i._FreeAttached||, CODE, READONLY, ALIGN=1

                  _FreeAttached PROC
;;;613    */
;;;614    static void _FreeAttached(LISTVIEW_Obj * pObj) {
000000  e92d47f0          PUSH     {r4-r10,lr}
000004  4604              MOV      r4,r0
;;;615      int i, j, NumRows, NumColumns;
;;;616      NumRows    = LISTVIEW__GetNumRows(pObj);
000006  f7fffffe          BL       LISTVIEW__GetNumRows
00000a  4680              MOV      r8,r0
;;;617      NumColumns = LISTVIEW__GetNumColumns(pObj);
00000c  4620              MOV      r0,r4
00000e  f7fffffe          BL       LISTVIEW__GetNumColumns
000012  4607              MOV      r7,r0
;;;618      for (i = 0; i < NumRows; i++) {
000014  2600              MOVS     r6,#0
;;;619        LISTVIEW_ROW* pRow;
;;;620        pRow = (LISTVIEW_ROW*) GUI_ARRAY_GetpItem(&pObj->RowArray, i);
000016  f1040a2a          ADD      r10,r4,#0x2a
00001a  e017              B        |L18.76|
                  |L18.28|
00001c  4631              MOV      r1,r6
00001e  4650              MOV      r0,r10
000020  f7fffffe          BL       GUI_ARRAY_GetpItem
000024  4681              MOV      r9,r0
;;;621        /* Delete attached info items */
;;;622        for (j = 0; j < NumColumns; j++) {
000026  2500              MOVS     r5,#0
000028  e00a              B        |L18.64|
                  |L18.42|
;;;623          LISTVIEW_CELL* pCell;
;;;624          pCell = (LISTVIEW_CELL*) GUI_ARRAY_GetpItem(&pRow->CellArray, j);
00002a  4629              MOV      r1,r5
00002c  4648              MOV      r0,r9
00002e  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;625          if (pCell) {
000032  b120              CBZ      r0,|L18.62|
;;;626            if (pCell->hCellInfo) {
000034  f9b00000          LDRSH    r0,[r0,#0]
000038  b108              CBZ      r0,|L18.62|
;;;627              GUI_ALLOC_Free(pCell->hCellInfo);
00003a  f7fffffe          BL       GUI_ALLOC_Free
                  |L18.62|
00003e  1c6d              ADDS     r5,r5,#1
                  |L18.64|
000040  42bd              CMP      r5,r7                 ;622
000042  dbf2              BLT      |L18.42|
;;;628            }
;;;629          }
;;;630        }
;;;631        /* Delete row */
;;;632        GUI_ARRAY_Delete(&pRow->CellArray);
000044  4648              MOV      r0,r9
000046  f7fffffe          BL       GUI_ARRAY_Delete
00004a  1c76              ADDS     r6,r6,#1
                  |L18.76|
00004c  4546              CMP      r6,r8                 ;618
00004e  dbe5              BLT      |L18.28|
;;;633      }
;;;634      /* Delete sort object */
;;;635      if (pObj->hSort) {
000050  f9b40092          LDRSH    r0,[r4,#0x92]
000054  b128              CBZ      r0,|L18.98|
;;;636        ((LISTVIEW_SORT *)GUI_ALLOC_h2p(pObj->hSort))->fpFree(pObj->hSort);
000056  f7fffffe          BL       GUI_ALLOC_h2p
00005a  6881              LDR      r1,[r0,#8]
00005c  f9b40092          LDRSH    r0,[r4,#0x92]
000060  4788              BLX      r1
                  |L18.98|
;;;637      }
;;;638      GUI_ARRAY_Delete(&pObj->ColumnArray);
000062  f104002e          ADD      r0,r4,#0x2e
000066  f7fffffe          BL       GUI_ARRAY_Delete
00006a  4650              MOV      r0,r10
;;;639      GUI_ARRAY_Delete(&pObj->RowArray);
00006c  e8bd47f0          POP      {r4-r10,lr}
000070  f7ffbffe          B.W      GUI_ARRAY_Delete
;;;640    }
;;;641    
                          ENDP


                          AREA ||i._GetNumVisibleRows||, CODE, READONLY, ALIGN=1

                  _GetNumVisibleRows PROC
;;;238    */
;;;239    static unsigned _GetNumVisibleRows(LISTVIEW_Handle hObj, const LISTVIEW_Obj* pObj) {
000000  b57c              PUSH     {r2-r6,lr}
000002  460e              MOV      r6,r1
;;;240      unsigned RowDistY, ySize, r = 1;
000004  2401              MOVS     r4,#1
;;;241      GUI_RECT Rect;
;;;242      WM_GetInsideRectExScrollbar(hObj, &Rect);
000006  4669              MOV      r1,sp
000008  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;243      ySize    = Rect.y1 - Rect.y0 + 1 - HEADER_GetHeight(pObj->hHeader);
00000c  f9b60028          LDRSH    r0,[r6,#0x28]
000010  f7fffffe          BL       HEADER_GetHeight
000014  f9bd1006          LDRSH    r1,[sp,#6]
000018  f9bd2002          LDRSH    r2,[sp,#2]
00001c  1a89              SUBS     r1,r1,r2
00001e  1a0d              SUBS     r5,r1,r0
;;;244      RowDistY = LISTVIEW__GetRowDistY(pObj);
000020  4630              MOV      r0,r6
000022  1c6d              ADDS     r5,r5,#1
000024  f7fffffe          BL       LISTVIEW__GetRowDistY
;;;245      if (RowDistY) {
000028  b118              CBZ      r0,|L19.50|
;;;246        r = ySize / RowDistY;
00002a  fbb5f4f0          UDIV     r4,r5,r0
;;;247        r = (r == 0) ? 1 : r;
00002e  b904              CBNZ     r4,|L19.50|
000030  2401              MOVS     r4,#1
                  |L19.50|
;;;248      }
;;;249      return r;
000032  4620              MOV      r0,r4
;;;250    }
000034  bd7c              POP      {r2-r6,pc}
;;;251    
                          ENDP


                          AREA ||i._NotifyOwner||, CODE, READONLY, ALIGN=1

                  _NotifyOwner PROC
;;;478    */
;;;479    static void _NotifyOwner(WM_HWIN hObj, int Notification) {
000000  b53e              PUSH     {r1-r5,lr}
000002  4605              MOV      r5,r0
;;;480      WM_MESSAGE Msg = {0};
000004  2000              MOVS     r0,#0
000006  9000              STR      r0,[sp,#0]
000008  9001              STR      r0,[sp,#4]
;;;481      WM_HWIN hOwner;
;;;482      LISTVIEW_Obj* pObj    = LISTVIEW_H2P(hObj);
00000a  9002              STR      r0,[sp,#8]
00000c  460c              MOV      r4,r1                 ;479
00000e  4628              MOV      r0,r5
000010  f7fffffe          BL       GUI_ALLOC_h2p
;;;483      hOwner = pObj->hOwner ? pObj->hOwner : WM_GetParent(hObj);
000014  f9b00090          LDRSH    r0,[r0,#0x90]
000018  b910              CBNZ     r0,|L20.32|
00001a  4628              MOV      r0,r5
00001c  f7fffffe          BL       WM_GetParent
                  |L20.32|
;;;484      Msg.MsgId   = WM_NOTIFY_PARENT;
000020  2126              MOVS     r1,#0x26
;;;485      Msg.Data.v  = Notification;
;;;486      Msg.hWinSrc = hObj;
000022  9100              STR      r1,[sp,#0]
000024  9402              STR      r4,[sp,#8]
000026  f8ad5006          STRH     r5,[sp,#6]
;;;487      WM__SendMessage(hOwner, &Msg);
00002a  4669              MOV      r1,sp
00002c  f7fffffe          BL       WM__SendMessage
;;;488    }
000030  bd3e              POP      {r1-r5,pc}
;;;489    
                          ENDP


                          AREA ||i._OnPage||, CODE, READONLY, ALIGN=1

                  _OnPage PROC
;;;658    */
;;;659    static void _OnPage(LISTVIEW_Handle hObj, LISTVIEW_Obj * pObj, int Dir) {
000000  b570              PUSH     {r4-r6,lr}
000002  0013              MOVS     r3,r2
000004  4605              MOV      r5,r0
000006  6fca              LDR      r2,[r1,#0x7c]
000008  6e08              LDR      r0,[r1,#0x60]
00000a  460c              MOV      r4,r1
00000c  d50e              BPL      |L21.44|
;;;660      if (Dir < 0) {
;;;661        /* Check if cursor is already on top row of the page */
;;;662        if (pObj->Sel != pObj->ScrollStateV.v) {
00000e  4290              CMP      r0,r2
000010  d004              BEQ      |L21.28|
                  |L21.18|
;;;663          /* If not, set cursor on top row */
;;;664          LISTVIEW__SetSel(hObj, pObj, pObj->ScrollStateV.v);
000012  4628              MOV      r0,r5
000014  e8bd4070          POP      {r4-r6,lr}
000018  f7ffbffe          B.W      LISTVIEW__SetSel
                  |L21.28|
;;;665        } else {
;;;666          /* Check if current selection is >= one page size */
;;;667          if (pObj->Sel >= pObj->ScrollStateV.PageSize) {
00001c  f8d41080          LDR      r1,[r4,#0x80]
000020  4288              CMP      r0,r1
000022  db01              BLT      |L21.40|
;;;668            /* Move selection one page up */
;;;669            LISTVIEW__MoveSel(hObj, pObj, -pObj->ScrollStateV.PageSize);
000024  424a              RSBS     r2,r1,#0
000026  e013              B        |L21.80|
                  |L21.40|
;;;670          } else {
;;;671            /* Set selection on top row */
;;;672            LISTVIEW__SetSel(hObj, pObj, 0);
000028  2200              MOVS     r2,#0
00002a  e005              B        |L21.56|
                  |L21.44|
;;;673          }
;;;674        }
;;;675      } else {
;;;676        int Pos;
;;;677        /* Check if cursor is already on bottom row of the page */
;;;678        Pos = pObj->ScrollStateV.v + pObj->ScrollStateV.PageSize - 1;
00002c  f8d41080          LDR      r1,[r4,#0x80]
000030  440a              ADD      r2,r2,r1
000032  1e52              SUBS     r2,r2,#1
;;;679        if (pObj->Sel != Pos) {
000034  4290              CMP      r0,r2
000036  d001              BEQ      |L21.60|
                  |L21.56|
;;;680          /* If not, set cursor on bottom row */
;;;681          LISTVIEW__SetSel(hObj, pObj, Pos);
000038  4621              MOV      r1,r4
00003a  e7ea              B        |L21.18|
                  |L21.60|
;;;682        } else {
;;;683          int NumItems;
;;;684          /* Check if current selection is <= (NumItems - PageSize - 1) */
;;;685          NumItems = LISTVIEW__GetNumRows(pObj);
00003c  4620              MOV      r0,r4
00003e  f7fffffe          BL       LISTVIEW__GetNumRows
;;;686          if (pObj->Sel < (NumItems - pObj->ScrollStateV.PageSize - 1)) {
000042  f8d42080          LDR      r2,[r4,#0x80]
000046  6e23              LDR      r3,[r4,#0x60]
000048  1a81              SUBS     r1,r0,r2
00004a  1e49              SUBS     r1,r1,#1
00004c  428b              CMP      r3,r1
00004e  da05              BGE      |L21.92|
                  |L21.80|
;;;687            /* Move selection one page down */
;;;688            LISTVIEW__MoveSel(hObj, pObj, pObj->ScrollStateV.PageSize);
000050  4621              MOV      r1,r4
000052  4628              MOV      r0,r5
000054  e8bd4070          POP      {r4-r6,lr}
000058  f7ffbffe          B.W      LISTVIEW__MoveSel
                  |L21.92|
;;;689          } else {
;;;690            /* Set selection on bottom row */
;;;691            LISTVIEW__SetSel(hObj, pObj, NumItems - 1);
00005c  1e42              SUBS     r2,r0,#1
00005e  e7eb              B        |L21.56|
;;;692          }
;;;693        }
;;;694      }
;;;695    }
;;;696    
                          ENDP


                          AREA ||i._Paint||, CODE, READONLY, ALIGN=2

                  _Paint PROC
;;;274    */
;;;275    static void _Paint(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, WM_MESSAGE* pMsg) {
000000  e92d4ff0          PUSH     {r4-r11,lr}
000004  4683              MOV      r11,r0
000006  b099              SUB      sp,sp,#0x64
000008  4615              MOV      r5,r2
00000a  460c              MOV      r4,r1
;;;276      const LISTVIEW_ROW* pRow;
;;;277      GUI_RECT ClipRect, Rect;
;;;278      int NumRows, NumVisRows, NumColumns;
;;;279      int LBorder, RBorder, EffectSize;
;;;280      int xPos, yPos, Width, RowDistY;
;;;281      int Align, i, j, EndRow;
;;;282      /* Init some values */
;;;283      NumColumns = LISTVIEW__GetNumColumns(pObj);
00000c  4608              MOV      r0,r1
00000e  f7fffffe          BL       LISTVIEW__GetNumColumns
000012  4607              MOV      r7,r0
;;;284      NumRows    = LISTVIEW__GetNumRows(pObj);
000014  4620              MOV      r0,r4
000016  f7fffffe          BL       LISTVIEW__GetNumRows
00001a  4680              MOV      r8,r0
;;;285      NumVisRows = _GetNumVisibleRows(hObj, pObj);
00001c  4621              MOV      r1,r4
00001e  4658              MOV      r0,r11
000020  f7fffffe          BL       _GetNumVisibleRows
000024  4682              MOV      r10,r0
;;;286      RowDistY   = LISTVIEW__GetRowDistY(pObj);
000026  4620              MOV      r0,r4
000028  f7fffffe          BL       LISTVIEW__GetRowDistY
;;;287      LBorder    = pObj->LBorder;
00002c  900d              STR      r0,[sp,#0x34]
00002e  6f20              LDR      r0,[r4,#0x70]
;;;288      RBorder    = pObj->RBorder;
000030  900f              STR      r0,[sp,#0x3c]
000032  6f60              LDR      r0,[r4,#0x74]
;;;289      EffectSize = pObj->Widget.pEffect->EffectSize;
000034  900e              STR      r0,[sp,#0x38]
000036  6a20              LDR      r0,[r4,#0x20]
;;;290      yPos       = HEADER_GetHeight(pObj->hHeader) + EffectSize;
000038  f8d09014          LDR      r9,[r0,#0x14]
00003c  f9b40028          LDRSH    r0,[r4,#0x28]
000040  f7fffffe          BL       HEADER_GetHeight
000044  eb000609          ADD      r6,r0,r9
;;;291      /* Calculate clipping rectangle */
;;;292      ClipRect = *(const GUI_RECT*)pMsg->Data.p;
000048  68a8              LDR      r0,[r5,#8]
00004a  6801              LDR      r1,[r0,#0]
00004c  9101              STR      r1,[sp,#4]
00004e  6840              LDR      r0,[r0,#4]
;;;293      GUI_MoveRect(&ClipRect, -pObj->Widget.Win.Rect.x0, -pObj->Widget.Win.Rect.y0);
000050  9002              STR      r0,[sp,#8]
000052  f9b40002          LDRSH    r0,[r4,#2]
000056  4242              RSBS     r2,r0,#0
000058  f9b40000          LDRSH    r0,[r4,#0]
00005c  4241              RSBS     r1,r0,#0
00005e  a801              ADD      r0,sp,#4
000060  f7fffffe          BL       GUI_MoveRect
;;;294      WM_GetInsideRectExScrollbar(hObj, &Rect);
000064  a904              ADD      r1,sp,#0x10
000066  4658              MOV      r0,r11
000068  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;295      GUI__IntersectRect(&ClipRect, &Rect);
00006c  a904              ADD      r1,sp,#0x10
00006e  a801              ADD      r0,sp,#4
000070  f7fffffe          BL       GUI__IntersectRect
;;;296      /* Set drawing color, font and text mode */
;;;297      LCD_SetColor(pObj->Props.aTextColor[0]);
000074  6c60              LDR      r0,[r4,#0x44]
000076  f7fffffe          BL       LCD_SetColor
;;;298      GUI_SetFont(pObj->Props.pFont);
00007a  6da0              LDR      r0,[r4,#0x58]
00007c  f7fffffe          BL       GUI_SetFont
;;;299      GUI_SetTextMode(GUI_TM_TRANS);
000080  2002              MOVS     r0,#2
000082  f7fffffe          BL       GUI_SetTextMode
;;;300      /* Sort before drawing, because scroll position may change */
;;;301      if (pObj->hSort && (pObj->SortIndex >= 0)) {
000086  f9b40092          LDRSH    r0,[r4,#0x92]
00008a  b148              CBZ      r0,|L22.160|
00008c  6ea1              LDR      r1,[r4,#0x68]
00008e  2900              CMP      r1,#0
000090  db06              BLT      |L22.160|
;;;302        LISTVIEW_SORT * pSort;
;;;303        pSort = (LISTVIEW_SORT *)GUI_ALLOC_h2p(pObj->hSort);
000092  f7fffffe          BL       GUI_ALLOC_h2p
;;;304        if (pSort->fpSort(hObj)) {
000096  6841              LDR      r1,[r0,#4]
000098  4658              MOV      r0,r11
00009a  4788              BLX      r1
00009c  2800              CMP      r0,#0
00009e  d17d              BNE      |L22.412|
                  |L22.160|
;;;305          return; /* Return on error */
;;;306        }
;;;307      }
;;;308      /* Calculate end row after sorting, because scroll position may have changed */
;;;309      EndRow = pObj->ScrollStateV.v + (((NumVisRows + 1) > NumRows) ? NumRows : NumVisRows + 1);
0000a0  f10a0001          ADD      r0,r10,#1
0000a4  6fe5              LDR      r5,[r4,#0x7c]
0000a6  4540              CMP      r0,r8
0000a8  dc00              BGT      |L22.172|
0000aa  4680              MOV      r8,r0
                  |L22.172|
0000ac  f104002a          ADD      r0,r4,#0x2a
0000b0  eb050b08          ADD      r11,r5,r8
;;;310      /* Do the drawing */
;;;311      for (i = pObj->ScrollStateV.v; i < EndRow; i++) {
0000b4  9010              STR      r0,[sp,#0x40]
0000b6  e0c4              B        |L22.578|
                  |L22.184|
0000b8  f9b40092          LDRSH    r0,[r4,#0x92]
0000bc  b188              CBZ      r0,|L22.226|
0000be  6ea1              LDR      r1,[r4,#0x68]
0000c0  2900              CMP      r1,#0
0000c2  db0e              BLT      |L22.226|
0000c4  f7fffffe          BL       GUI_ALLOC_h2p
0000c8  4680              MOV      r8,r0
0000ca  f9b00000          LDRSH    r0,[r0,#0]
0000ce  f7fffffe          BL       GUI_ALLOC_h2p
0000d2  f8b82002          LDRH     r2,[r8,#2]
0000d6  4601              MOV      r1,r0
0000d8  42aa              CMP      r2,r5
0000da  dd71              BLE      |L22.448|
0000dc  f8311015          LDRH     r1,[r1,r5,LSL #1]
0000e0  e000              B        |L22.228|
                  |L22.226|
0000e2  4629              MOV      r1,r5
                  |L22.228|
0000e4  9810              LDR      r0,[sp,#0x40]
0000e6  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;312        pRow = _GetpRow(pObj, i);
;;;313        if (pRow) {
0000ea  9008              STR      r0,[sp,#0x20]
0000ec  2800              CMP      r0,#0
0000ee  d067              BEQ      |L22.448|
;;;314          Rect.y0 = yPos;
0000f0  b230              SXTH     r0,r6
;;;315          /* Break when all other rows are outside the drawing area */
;;;316          if (Rect.y0 > ClipRect.y1) {
0000f2  f9bd100a          LDRSH    r1,[sp,#0xa]
0000f6  f8ad0012          STRH     r0,[sp,#0x12]         ;314
0000fa  4288              CMP      r0,r1
0000fc  dc7d              BGT      |L22.506|
;;;317            break;
;;;318          }
;;;319          Rect.y1 = yPos + RowDistY - 1;
0000fe  980d              LDR      r0,[sp,#0x34]
;;;320          /* Make sure that we draw only when row is in drawing area */
;;;321          if (Rect.y1 >= ClipRect.y0) {
000100  f9bd1006          LDRSH    r1,[sp,#6]
000104  4430              ADD      r0,r0,r6              ;319
000106  9014              STR      r0,[sp,#0x50]         ;319
000108  1e40              SUBS     r0,r0,#1              ;319
00010a  b200              SXTH     r0,r0                 ;319
00010c  f8ad0016          STRH     r0,[sp,#0x16]         ;319
000110  4288              CMP      r0,r1
000112  db73              BLT      |L22.508|
;;;322            int ColorIndex;
;;;323            /* Set background color */
;;;324            if (pRow->Disabled) {
000114  9808              LDR      r0,[sp,#0x20]
000116  7900              LDRB     r0,[r0,#4]
000118  b108              CBZ      r0,|L22.286|
;;;325              ColorIndex = LISTVIEW_CI_DISABLED;
00011a  2003              MOVS     r0,#3
00011c  e009              B        |L22.306|
                  |L22.286|
;;;326            } else if (i == pObj->Sel) {
00011e  6e20              LDR      r0,[r4,#0x60]
000120  42a8              CMP      r0,r5
000122  d11a              BNE      |L22.346|
;;;327              ColorIndex = (pObj->Widget.State & WIDGET_STATE_FOCUS) ? LISTVIEW_CI_SELFOCUS : LISTVIEW_CI_SEL;
000124  f8940026          LDRB     r0,[r4,#0x26]
000128  07c0              LSLS     r0,r0,#31
00012a  d001              BEQ      |L22.304|
00012c  2002              MOVS     r0,#2
00012e  e000              B        |L22.306|
                  |L22.304|
000130  2001              MOVS     r0,#1
                  |L22.306|
;;;328            } else {
;;;329              ColorIndex = LISTVIEW_CI_UNSEL;
;;;330            }
;;;331            LCD_SetBkColor(pObj->Props.aBkColor[ColorIndex]);
000132  9011              STR      r0,[sp,#0x44]
000134  eb040080          ADD      r0,r4,r0,LSL #2
000138  9015              STR      r0,[sp,#0x54]
00013a  6b40              LDR      r0,[r0,#0x34]
00013c  f7fffffe          BL       LCD_SetBkColor
;;;332            /* Iterate over all columns */
;;;333            if (pObj->ShowGrid) {
000140  6e60              LDR      r0,[r4,#0x64]
000142  b120              CBZ      r0,|L22.334|
;;;334              Rect.y1--;
000144  f8bd0016          LDRH     r0,[sp,#0x16]
000148  1e40              SUBS     r0,r0,#1
00014a  f8ad0016          STRH     r0,[sp,#0x16]
                  |L22.334|
;;;335            }
;;;336            xPos = EffectSize - pObj->ScrollStateH.v;
00014e  f8d41088          LDR      r1,[r4,#0x88]
;;;337            for (j = 0; j < NumColumns; j++) {
000152  2600              MOVS     r6,#0
000154  eba90801          SUB      r8,r9,r1              ;336
000158  e064              B        |L22.548|
                  |L22.346|
00015a  2000              MOVS     r0,#0                 ;329
00015c  e7e9              B        |L22.306|
;;;338              Width   = HEADER_GetItemWidth(pObj->hHeader, j);
00015e  bf00              NOP      
                  |L22.352|
000160  f9b40028          LDRSH    r0,[r4,#0x28]
000164  4631              MOV      r1,r6
000166  f7fffffe          BL       HEADER_GetItemWidth
;;;339              Rect.x0 = xPos;
00016a  fa0ff188          SXTH     r1,r8
;;;340              /* Break when all other columns are outside the drawing area */
;;;341              if (Rect.x0 > ClipRect.x1) {
00016e  f9bd2008          LDRSH    r2,[sp,#8]
000172  f8ad1010          STRH     r1,[sp,#0x10]         ;339
000176  4291              CMP      r1,r2
000178  dc56              BGT      |L22.552|
;;;342                break;
;;;343              }
;;;344              Rect.x1 = xPos + Width - 1;
00017a  4480              ADD      r8,r8,r0
00017c  f1a80001          SUB      r0,r8,#1
000180  b200              SXTH     r0,r0
;;;345              /* Make sure that we draw only when column is in drawing area */
;;;346              if (Rect.x1 >= ClipRect.x0) {
000182  f9bd1004          LDRSH    r1,[sp,#4]
000186  f8ad0014          STRH     r0,[sp,#0x14]         ;344
00018a  4288              CMP      r0,r1
00018c  db49              BLT      |L22.546|
;;;347                LISTVIEW_COLUMN* pColumn;
;;;348                LISTVIEW_CELL* pCell;
;;;349                pCell = (LISTVIEW_CELL*)GUI_ARRAY_GetpItem(&pRow->CellArray, j);
00018e  4631              MOV      r1,r6
000190  9808              LDR      r0,[sp,#0x20]
000192  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;350                if (pCell) {
000196  9017              STR      r0,[sp,#0x5c]
000198  b388              CBZ      r0,|L22.510|
;;;351                  if (pCell->hCellInfo) {
00019a  e000              B        |L22.414|
                  |L22.412|
00019c  e0a9              B        |L22.754|
                  |L22.414|
00019e  f9b00000          LDRSH    r0,[r0,#0]
0001a2  b170              CBZ      r0,|L22.450|
;;;352                    LISTVIEW_CELL_INFO* pCellInfo;
;;;353                    pCellInfo = (LISTVIEW_CELL_INFO*) GUI_ALLOC_h2p(pCell->hCellInfo);
0001a4  f7fffffe          BL       GUI_ALLOC_h2p
;;;354                    LCD_SetBkColor(pCellInfo->aBkColor[ColorIndex]);
0001a8  9911              LDR      r1,[sp,#0x44]
0001aa  9000              STR      r0,[sp,#0]
0001ac  f8500021          LDR      r0,[r0,r1,LSL #2]
0001b0  f7fffffe          BL       LCD_SetBkColor
;;;355                    LCD_SetColor(pCellInfo->aTextColor[ColorIndex]);
0001b4  9911              LDR      r1,[sp,#0x44]
0001b6  9800              LDR      r0,[sp,#0]
0001b8  eb000081          ADD      r0,r0,r1,LSL #2
0001bc  6900              LDR      r0,[r0,#0x10]
;;;356                  } else {
0001be  e002              B        |L22.454|
                  |L22.448|
0001c0  e03e              B        |L22.576|
                  |L22.450|
;;;357                    LCD_SetColor(pObj->Props.aTextColor[ColorIndex]);
0001c2  9815              LDR      r0,[sp,#0x54]
0001c4  6c40              LDR      r0,[r0,#0x44]
                  |L22.454|
0001c6  f7fffffe          BL       LCD_SetColor
;;;358                  }
;;;359                  /* Clear background */
;;;360                  GUI_ClearRect(Rect.x0, Rect.y0, Rect.x1, Rect.y1);
0001ca  f9bd3016          LDRSH    r3,[sp,#0x16]
0001ce  f9bd2014          LDRSH    r2,[sp,#0x14]
0001d2  f9bd1012          LDRSH    r1,[sp,#0x12]
0001d6  f9bd0010          LDRSH    r0,[sp,#0x10]
0001da  f7fffffe          BL       GUI_ClearRect
;;;361                  /* Draw text */
;;;362                  Rect.x0 += LBorder;
0001de  f8bd1010          LDRH     r1,[sp,#0x10]
0001e2  980f              LDR      r0,[sp,#0x3c]
0001e4  4408              ADD      r0,r0,r1
0001e6  f8ad0010          STRH     r0,[sp,#0x10]
;;;363                  Rect.x1 -= RBorder;
0001ea  f8bd1014          LDRH     r1,[sp,#0x14]
0001ee  980e              LDR      r0,[sp,#0x38]
0001f0  1a08              SUBS     r0,r1,r0
0001f2  f8ad0014          STRH     r0,[sp,#0x14]
;;;364                  pColumn = (LISTVIEW_COLUMN*) GUI_ARRAY_GetpItem(&pObj->ColumnArray, j);
0001f6  4631              MOV      r1,r6
0001f8  e002              B        |L22.512|
                  |L22.506|
0001fa  e025              B        |L22.584|
                  |L22.508|
0001fc  e01f              B        |L22.574|
                  |L22.510|
0001fe  e010              B        |L22.546|
                  |L22.512|
000200  f104002e          ADD      r0,r4,#0x2e
000204  f7fffffe          BL       GUI_ARRAY_GetpItem
;;;365                  Align = pColumn->Align;
000208  7802              LDRB     r2,[r0,#0]
;;;366                  GUI_DispStringInRect(pCell->acText, &Rect, Align);
00020a  9817              LDR      r0,[sp,#0x5c]
00020c  a904              ADD      r1,sp,#0x10
00020e  1c80              ADDS     r0,r0,#2
000210  f7fffffe          BL       GUI_DispStringInRect
;;;367                  if (pCell->hCellInfo) {
000214  9817              LDR      r0,[sp,#0x5c]
000216  8800              LDRH     r0,[r0,#0]
000218  b118              CBZ      r0,|L22.546|
;;;368                    LCD_SetBkColor(pObj->Props.aBkColor[ColorIndex]);
00021a  9815              LDR      r0,[sp,#0x54]
00021c  6b40              LDR      r0,[r0,#0x34]
00021e  f7fffffe          BL       LCD_SetBkColor
                  |L22.546|
000222  1c76              ADDS     r6,r6,#1
                  |L22.548|
000224  42be              CMP      r6,r7                 ;337
000226  db9b              BLT      |L22.352|
                  |L22.552|
;;;369                  }
;;;370                }
;;;371              }
;;;372              xPos += Width;
;;;373            }
;;;374            /* Clear unused area to the right of items */
;;;375            if (xPos <= ClipRect.x1) {
000228  f9bd2008          LDRSH    r2,[sp,#8]
00022c  4640              MOV      r0,r8
00022e  4542              CMP      r2,r8
000230  db05              BLT      |L22.574|
;;;376              GUI_ClearRect(xPos, Rect.y0, ClipRect.x1, Rect.y1);
000232  f9bd3016          LDRSH    r3,[sp,#0x16]
000236  f9bd1012          LDRSH    r1,[sp,#0x12]
00023a  f7fffffe          BL       GUI_ClearRect
                  |L22.574|
00023e  9e14              LDR      r6,[sp,#0x50]
                  |L22.576|
000240  1c6d              ADDS     r5,r5,#1
                  |L22.578|
000242  455d              CMP      r5,r11                ;311
000244  f6ffaf38          BLT      |L22.184|
                  |L22.584|
;;;377            }
;;;378          }
;;;379          yPos += RowDistY;
;;;380        }
;;;381      }
;;;382      /* Clear unused area below items */
;;;383      if (yPos <= ClipRect.y1) {
000248  f9bd000a          LDRSH    r0,[sp,#0xa]
00024c  42b0              CMP      r0,r6
00024e  db0b              BLT      |L22.616|
;;;384        LCD_SetBkColor(pObj->Props.aBkColor[0]);
000250  6b60              LDR      r0,[r4,#0x34]
000252  f7fffffe          BL       LCD_SetBkColor
;;;385        GUI_ClearRect(ClipRect.x0, yPos, ClipRect.x1, ClipRect.y1);
000256  f9bd300a          LDRSH    r3,[sp,#0xa]
00025a  f9bd2008          LDRSH    r2,[sp,#8]
00025e  f9bd0004          LDRSH    r0,[sp,#4]
000262  4631              MOV      r1,r6
000264  f7fffffe          BL       GUI_ClearRect
                  |L22.616|
;;;386      }
;;;387      /* Draw grid */
;;;388      if (pObj->ShowGrid) {
000268  6e60              LDR      r0,[r4,#0x64]
00026a  b3e8              CBZ      r0,|L22.744|
;;;389        LCD_SetColor(pObj->Props.GridColor);
00026c  6d60              LDR      r0,[r4,#0x54]
00026e  f7fffffe          BL       LCD_SetColor
;;;390        yPos = HEADER_GetHeight(pObj->hHeader) + EffectSize - 1;
000272  f9b40028          LDRSH    r0,[r4,#0x28]
000276  f7fffffe          BL       HEADER_GetHeight
00027a  eb000509          ADD      r5,r0,r9
;;;391        for (i = 0; i < NumVisRows; i++) {
00027e  2600              MOVS     r6,#0
000280  1e6d              SUBS     r5,r5,#1
000282  e011              B        |L22.680|
                  |L22.644|
;;;392          yPos += RowDistY;
000284  980d              LDR      r0,[sp,#0x34]
000286  4405              ADD      r5,r5,r0
;;;393          /* Break when all other rows are outside the drawing area */
;;;394          if (yPos > ClipRect.y1) {
000288  f9bd000a          LDRSH    r0,[sp,#0xa]
00028c  42a8              CMP      r0,r5
00028e  db0d              BLT      |L22.684|
;;;395            break;
;;;396          }
;;;397          /* Make sure that we draw only when row is in drawing area */
;;;398          if (yPos >= ClipRect.y0) {
000290  f9bd0006          LDRSH    r0,[sp,#6]
000294  42a8              CMP      r0,r5
000296  dc06              BGT      |L22.678|
;;;399            GUI_DrawHLine(yPos, ClipRect.x0, ClipRect.x1);
000298  f9bd2008          LDRSH    r2,[sp,#8]
00029c  f9bd1004          LDRSH    r1,[sp,#4]
0002a0  4628              MOV      r0,r5
0002a2  f7fffffe          BL       GUI_DrawHLine
                  |L22.678|
0002a6  1c76              ADDS     r6,r6,#1
                  |L22.680|
0002a8  4556              CMP      r6,r10                ;391
0002aa  dbeb              BLT      |L22.644|
                  |L22.684|
;;;400          }
;;;401        }
;;;402        xPos = EffectSize - pObj->ScrollStateH.v;
0002ac  f8d40088          LDR      r0,[r4,#0x88]
;;;403        for (i = 0; i < NumColumns; i++) {
0002b0  2600              MOVS     r6,#0
0002b2  eba90500          SUB      r5,r9,r0              ;402
0002b6  e015              B        |L22.740|
                  |L22.696|
;;;404          xPos += HEADER_GetItemWidth(pObj->hHeader, i);
0002b8  f9b40028          LDRSH    r0,[r4,#0x28]
0002bc  4631              MOV      r1,r6
0002be  f7fffffe          BL       HEADER_GetItemWidth
0002c2  4405              ADD      r5,r5,r0
;;;405          /* Break when all other columns are outside the drawing area */
;;;406          if (xPos > ClipRect.x1) {
0002c4  f9bd0008          LDRSH    r0,[sp,#8]
0002c8  42a8              CMP      r0,r5
0002ca  db0f              BLT      |L22.748|
;;;407            break;
;;;408          }
;;;409          /* Make sure that we draw only when column is in drawing area */
;;;410          if (xPos >= ClipRect.x0) {
0002cc  f9bd0004          LDRSH    r0,[sp,#4]
0002d0  42a8              CMP      r0,r5
0002d2  dc06              BGT      |L22.738|
;;;411            GUI_DrawVLine(xPos, ClipRect.y0, ClipRect.y1);
0002d4  f9bd200a          LDRSH    r2,[sp,#0xa]
0002d8  f9bd1006          LDRSH    r1,[sp,#6]
0002dc  4628              MOV      r0,r5
0002de  f7fffffe          BL       GUI_DrawVLine
                  |L22.738|
0002e2  1c76              ADDS     r6,r6,#1
                  |L22.740|
0002e4  42be              CMP      r6,r7                 ;403
0002e6  e000              B        |L22.746|
                  |L22.744|
0002e8  e000              B        |L22.748|
                  |L22.746|
0002ea  dbe5              BLT      |L22.696|
                  |L22.748|
;;;412          }
;;;413        }
;;;414      }
;;;415      /* Draw the effect */
;;;416      WIDGET__EFFECT_DrawDown(&pObj->Widget);
0002ec  4620              MOV      r0,r4
0002ee  f7fffffe          BL       WIDGET__EFFECT_DrawDown
                  |L22.754|
;;;417    }
0002f2  b019              ADD      sp,sp,#0x64
0002f4  e8bd8ff0          POP      {r4-r11,pc}
;;;418    
                          ENDP


                          AREA ||i._SetSelFromPos||, CODE, READONLY, ALIGN=1

                  _SetSelFromPos PROC
;;;452    */
;;;453    static void _SetSelFromPos(LISTVIEW_Handle hObj, LISTVIEW_Obj* pObj, const GUI_PID_STATE* pState) {
000000  e92d41fc          PUSH     {r2-r8,lr}
000004  4607              MOV      r7,r0
000006  4614              MOV      r4,r2
000008  460e              MOV      r6,r1
;;;454      GUI_RECT Rect;
;;;455      int x, y, HeaderHeight;
;;;456      HeaderHeight = HEADER_GetHeight(pObj->hHeader);
00000a  f9b10028          LDRSH    r0,[r1,#0x28]
00000e  f7fffffe          BL       HEADER_GetHeight
000012  4605              MOV      r5,r0
;;;457      WM_GetInsideRectExScrollbar(hObj, &Rect);
000014  4669              MOV      r1,sp
000016  4638              MOV      r0,r7
000018  f7fffffe          BL       WM_GetInsideRectExScrollbar
;;;458      x = pState->x - Rect.x0;
;;;459      y = pState->y - Rect.y0 - HeaderHeight;
00001c  f9bd1002          LDRSH    r1,[sp,#2]
000020  6863              LDR      r3,[r4,#4]
000022  6820              LDR      r0,[r4,#0]            ;458
000024  eba30301          SUB      r3,r3,r1
000028  f9bd2000          LDRSH    r2,[sp,#0]            ;458
00002c  eba30405          SUB      r4,r3,r5
;;;460      Rect.x1 -= Rect.x0;
000030  f8bd3004          LDRH     r3,[sp,#4]
000034  1a80              SUBS     r0,r0,r2              ;458
000036  eba30202          SUB      r2,r3,r2
00003a  b212              SXTH     r2,r2
00003c  f8ad2004          STRH     r2,[sp,#4]
;;;461      Rect.y1 -= Rect.y0;
000040  f8bd3006          LDRH     r3,[sp,#6]
000044  eba30101          SUB      r1,r3,r1
000048  b209              SXTH     r1,r1
00004a  f8ad1006          STRH     r1,[sp,#6]
;;;462      if ((x >= 0) && (x <= Rect.x1) && (y >= 0) && (y <= (Rect.y1 - HeaderHeight))) {
00004e  d417              BMI      |L23.128|
000050  4282              CMP      r2,r0
000052  db15              BLT      |L23.128|
000054  2c00              CMP      r4,#0
000056  db13              BLT      |L23.128|
000058  1b48              SUBS     r0,r1,r5
00005a  42a0              CMP      r0,r4
00005c  db10              BLT      |L23.128|
;;;463        unsigned Sel;
;;;464        Sel = (y / LISTVIEW__GetRowDistY(pObj)) + pObj->ScrollStateV.v;
00005e  4630              MOV      r0,r6
000060  f7fffffe          BL       LISTVIEW__GetRowDistY
000064  fbb4f0f0          UDIV     r0,r4,r0
000068  6ff1              LDR      r1,[r6,#0x7c]
00006a  1844              ADDS     r4,r0,r1
;;;465        if (Sel < LISTVIEW__GetNumRows(pObj)) {
00006c  4630              MOV      r0,r6
00006e  f7fffffe          BL       LISTVIEW__GetNumRows
000072  42a0              CMP      r0,r4
000074  d904              BLS      |L23.128|
;;;466          LISTVIEW__SetSel(hObj, pObj, Sel);
000076  4622              MOV      r2,r4
000078  4631              MOV      r1,r6
00007a  4638              MOV      r0,r7
00007c  f7fffffe          BL       LISTVIEW__SetSel
                  |L23.128|
;;;467        }
;;;468      }
;;;469    }
000080  e8bd81fc          POP      {r2-r8,pc}
;;;470    
                          ENDP


                          AREA ||.data||, DATA, ALIGN=2

                  LISTVIEW_DefaultProps
                          DCD      0x00ffffff
                          DCD      0x00808080
                          DCD      0x00ff0000
                          DCD      0x00d3d3d3
                          DCD      0x00000000
                          DCD      0x00ffffff
                          DCD      0x00ffffff
                          DCD      0x00808080
                          DCD      0x00d3d3d3
                          DCD      GUI_Font13_1
000028  000a              DCW      0x000a
00002a  0000              DCB      0x00,0x00
